var xmlHttp;function GetXmlHttpObject(){if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}return xmlhttp}function getLabelsPost(){xmlHttp=GetXmlHttpObject();if(xmlHttp==null){alert("您当前浏览器版本过低，请升级或者更换其他浏览器浏览本页信息!");return}var a=publicParameterObj.parameters.adminUrlHead+publicParameterObj.parameters.getOwnerInfo;xmlhttp.open("POST",a,true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send();xmlHttp.onreadystatechange=getOkPost}function getOkPost(){if(xmlHttp.readyState==4&&xmlHttp.status==200){var b=xmlHttp.responseText;var a=JSON.parse(b);if(a.status==="F"&&a.message==="未授权企业"){window.location.replace("serverstop.html")}}}getLabelsPost();var mobileEvt={webpage_mobile:function(a){var b=window.open(a.url,"_blank","location=yes,closebuttoncaption=关闭,transitionstyle=crossdissolve,presentationstyle=pagesheet");b.addEventListener("loaderror",function(c){a.showAlert("提 示","error: "+c.message)})}};var operatingDatabaseEvent={crateTable:function(){if(localStorage.getItem("spc")===undefined||localStorage.getItem("spc")===null){var a=[];localStorage.setItem("spc",JSON.stringify(a))}},insertData:function(h,f,e,d){var g=JSON.parse(localStorage.getItem("spc"));var b=g.length;for(var c=0,a=g.length;c<a;c++){if(e==="默认"){if(g[c].myid==h){d.showAlert("提 示","该商品已存在购物车中!");return}}else{if(g[c].myType===e){d.showAlert("提 示","该商品已存在购物车中!");return}}}g.push({myid:h,mynumber:f,myType:e});localStorage.setItem("spc",JSON.stringify(g));if(g.length>b){d.viewStates.setShoppingCarState(false);d.showAlert("提 示","添加成功!");d.closeSelType()}else{d.showAlert("提 示","添加失败!");d.closeSelType()}},selectData:function(){var a=JSON.parse(localStorage.getItem("spc"));return a},updateData:function(f,d,c){var e=JSON.parse(localStorage.getItem("spc"));for(var b=0,a=e.length;b<a;b++){if(e[b].myid===f){if(c==="默认"||(c===e[b].myType)){if(e[b].mynumber!=d){e[b].mynumber=d;localStorage.setItem("spc",JSON.stringify(e));return}return}}}},deleteItemData:function(d){var c=JSON.parse(localStorage.getItem("spc"));for(var b=0,a=c.length;b<a;b++){if(c[b].myid===d){c.splice(b,1);localStorage.setItem("spc",JSON.stringify(c));return}}},deleteallData:function(){localStorage.removeItem("spc");publicEventsObj.operatingDatabaseEvent.crateTable()}};var publicEventsClass={mobileEvent:Object.create(mobileEvt),operatingDatabaseEvent:Object.create(operatingDatabaseEvent)};var publicEventsObj=Object.create(publicEventsClass);var indexModule=angular.module("ionicApp",["ionic"]);var iconfig=function(b,a){publicEventsObj.operatingDatabaseEvent.crateTable();b.state("index",{url:"/index",templateUrl:"index.html",controller:"index"}).state("product",{url:"/product",templateUrl:"product.html",controller:"product"}).state("about",{url:"/about",templateUrl:"about.html",controller:"about"}).state("contact",{url:"/contact",templateUrl:"contact.html",controller:"contact"}).state("detailed",{url:"/detailed",templateUrl:"detailed.html",controller:"detailed"}).state("message",{url:"/message",templateUrl:"message.html",controller:"message"}).state("category",{url:"/category",templateUrl:"category.html",controller:"category"}).state("searchRes",{url:"/searchRes",templateUrl:"proSearchResList.html",controller:"searchRes"}).state("shoppingCar",{url:"/shoppingCar",templateUrl:"shoppingCar.html",controller:"shoppingCar"}).state("personal",{url:"/personal",templateUrl:"personal.html",controller:"personal"}).state("modifyPass",{url:"/modifyPass",templateUrl:"userModifyPass.html",controller:"modifyPass"}).state("modifyInfo",{url:"/modifyInfo",templateUrl:"userModifyInfo.html",controller:"modifyInfo"}).state("myOrder",{url:"/myOrder",templateUrl:"myOrder.html",controller:"myOrder"}).state("superPro",{url:"/superPro",templateUrl:"superPro.html",controller:"superPro"}).state("payType",{url:"/payType",templateUrl:"payType.html",controller:"payType"});a.otherwise("/index")};var imainCtrl=function(h,l,s,C,g,w,j,A,f,o,t){s.tabBarHide=false;s.search={};s.sendMessageIsLogin=true;s.iMessageDatas="";s.indexIsShow=false;s.proIsShow=false;s.categoryIsShow=false;s.shoppingCarIsShow=false;if(localStorage.getItem("perSpCar")==undefined){localStorage.setItem("perSpCar",0)}s.perSpCar=localStorage.getItem("perSpCar")>>0;s.viewStates={};s.iState=false;var c=false;var i={},x={};var v=false;var d=false;var a=false;var u=false;var e=false;var k=false;var B=false;var r=false;var z=false;var n=false;var m=false;var b=false;var y=false;var q=false;s.getisPay=function(){return c};s.setisPay=function(D){c=D};s.getpayTypesArr_a=function(){return i};s.getpayTypesArr_w=function(){return x};s.setpayTypesArr_a=function(D){i=D};s.setpayTypesArr_w=function(D){x=D};s.viewStates.getIndexState=function(){return v};s.viewStates.setIndexState=function(D){v=D};s.viewStates.getProductState=function(){return d};s.viewStates.setProductState=function(D){d=D};s.viewStates.getProListState=function(){return a};s.viewStates.setProListState=function(D){a=D};s.viewStates.getAboutState=function(){return u};s.viewStates.setAboutState=function(D){u=D};s.viewStates.getContactState=function(){return e};s.viewStates.setContactState=function(D){e=D};s.viewStates.getMessageState=function(){return k};s.viewStates.setMessageState=function(D){k=D};s.viewStates.getShoppingCarState=function(){return z};s.viewStates.setShoppingCarState=function(D){z=D};s.viewStates.getCategoryState=function(){return B};s.viewStates.setCategoryState=function(D){B=D};s.viewStates.getSearchResListState=function(){return r};s.viewStates.setSearchResListState=function(D){r=D};s.viewStates.getPersonalState=function(){return n};s.viewStates.setPersonalState=function(D){n=D};s.viewStates.getModifyState=function(){return m};s.viewStates.setModifyState=function(D){m=D};s.viewStates.getMyOrderState=function(){return b};s.viewStates.setMyOrderState=function(D){b=D};s.viewStates.getSuperProState=function(){return y};s.viewStates.setSuperProState=function(D){y=D};s.viewStates.getWaitingState=function(){return q};s.viewStates.setWaitingState=function(D){q=D};s.showAlert=function(E,D){s.iShowAlert=j.alert({title:E,content:D,buttons:[{text:"确 定",type:"alertCancel"}]});s.iShowAlert.then(function(F){})};s.tabBarToPage=function(D){s.isSpNewPage=false;switch(D){case 0:if(s.indexIsShow===false){if(s.perSpCar!=0){var F=s.perSpCar+s.getIsIndex()+s.getIsDetailed()+s.getCategory()+s.getProduct();s.back(-F)}else{if(s.getIsIndex()>0||s.getIsDetailed()>0){var E=s.perSpCar+s.getIsIndex()+s.getIsDetailed()+s.getCategory()+s.getProduct();s.back(-E)}else{g.path("/index").replace()}}}break;case 1:if(s.proIsShow===false){s.setIState(true);if(s.isIndex===true){g.path("/product");s.setIsIndex(1)}else{if(s.perSpCar>0&&s.getProduct()===0){g.path("/product");s.setProduct(1)}else{if(s.getProduct()===1){window.history.go(-1);s.setCategory(0);s.setProduct(1)}else{g.path("/product").replace()}}}}break;case 2:if(s.categoryIsShow===false){s.setIState(true);if(s.isIndex===true){g.path("/category");s.setIsIndex(1)}else{if(s.perSpCar>0&&s.getCategory()===0){g.path("/category");s.setCategory(1)}else{if(s.getCategory()===1){window.history.go(-1);s.setCategory(1);s.setProduct(0)}else{g.path("/category").replace()}}}}break;case 3:if(s.shoppingCarIsShow===false){if(s.isIndex===true){g.path("/shoppingCar");s.setIsIndex(1)}else{if(s.getCategory()!==0||s.getProduct()!==0){window.history.go(-(s.getCategory()+s.getProduct()));if(s.getCategory()===1){s.setCategory(0)}if(s.getProduct()===1){s.setProduct(0)}}else{g.path("/shoppingCar").replace()}}}break}};s.setPerSpCar=function(D){s.perSpCar=D;localStorage.setItem("perSpCar",D)};s.getPerSpCar=function(){var D=localStorage.getItem("perSpCar");D=!!D?parseInt(D):!!D;s.perSpCar=D;return s.perSpCar};s.setIsIndex=function(D){localStorage.setItem("isIndex",D)};s.getIsIndex=function(){var D=localStorage.getItem("isIndex");return !!D?parseInt(D):!!D};s.setIsDetailed=function(E){if(E==0){localStorage.setItem("isDetailed",E)}else{if(privateVerifictionObj.verifiction.isNotNull(s.getIsDetailed())===true&&s.getIsDetailed()>0){var D=parseInt(s.getIsDetailed())+parseInt(E);localStorage.setItem("isDetailed",D)}else{localStorage.setItem("isDetailed",E)}}};s.getIsDetailed=function(){var D=localStorage.getItem("isDetailed");return !!D?parseInt(D):!!D};s.setCategory=function(D){localStorage.setItem("isCategory",D)};s.getCategory=function(){var D=localStorage.getItem("isCategory");return !!D?parseInt(D):!!D};s.setProduct=function(D){localStorage.setItem("isProduct",D)};s.getProduct=function(){var D=localStorage.getItem("isProduct");return !!D?parseInt(D):!!D};s.getMessage=function(){return s.iMessageDatas};s.setMessage=function(D){s.iMessageDatas=D};s.getIState=function(){return s.iState};s.setIState=function(D){s.iState=D};s.back=function(D){if(privateVerifictionObj.verifiction.isNotNull(D)===true&&D!=0){window.history.go(D);if(s.perSpCar>2){var F=s.perSpCar+D;s.setPerSpCar(F)}}else{if(s.perSpCar>0&&D!=0){var E=s.perSpCar-1;s.setPerSpCar(E)}window.history.back()}};s.userLoginLoad=function(){w(function(){s.userLoginShowHide(true)},500)};s.pageHide=function(){if(s.userLogin){if(s.userLogin.isShown()){s.userLoginShowHide(false)}}if(s.iregister){if(s.iregister.isShown()){s.userRegisterShowHide(false)}}};s.$on("$stateChangeStart",function(E,D){publicParameterObj.parameters.loadingPage=0;s.isIndex=D.name==="index";s.indexIsShow=false;s.proIsShow=false;s.categoryIsShow=false;s.shoppingCarIsShow=false;s.navBarIsHide=false;if(s.iShowAlert){s.iShowAlert.close()}s.isSpNewPage=true;if(t.viewHistory().histories.root.cursor==-1){if(D.name==="index"){localStorage.removeItem("view")}if(localStorage.getItem("view")!==undefined&&localStorage.getItem("view")!==null){t.sviewHistory(JSON.parse(localStorage.getItem("view")))}getOrPostRequestObj.adminPayConnect.admGetPayTypes(s,C)}localStorage.setItem("view",JSON.stringify(t.viewHistory()));if(D.name==="index"||D.name==="category"||D.name==="shoppingCar"||D.name==="product"){switch(D.name){case"index":s.indexBarIconState();s.setPerSpCar(0);s.setIsIndex(0);s.setIsDetailed(0);s.setProduct(0);s.setCategory(0);break;case"category":s.categoryBarIconState();s.navBarIsHide=true;break;case"shoppingCar":s.shoppingCarIconState();break;case"product":s.proBarIconState();break}if(s.tabBarHide){w(function(){s.tabBarHide=false},300)}}else{if(D.name==="personal"){s.tabBarHide=true}else{s.tabBarHide=true}}s.pageHide()});s.toPersonal=function(){if(s.perSpCar!==0){s.back(-(s.perSpCar+s.getProduct()+s.getCategory()-1));s.setPerSpCar(0);s.setProduct(0);s.setCategory(0)}else{g.path("/personal")}};s.indexBarIconState=function(){s.indexIsShow=!s.indexIsShow};s.proBarIconState=function(){s.proIsShow=!s.proIsShow};s.categoryBarIconState=function(){s.categoryIsShow=!s.categoryIsShow};s.shoppingCarIconState=function(){s.shoppingCarIsShow=!s.shoppingCarIsShow};f.fromTemplateUrl("userLogin.html",function(D){s.userLogin=D},{scope:s,animation:"slide-in-up"});f.fromTemplateUrl("register.html",function(D){s.iregister=D},{scope:s,animation:"slide-in-up"});f.fromTemplateUrl("editMessage.html",function(D){s.editContent=D},{scope:s,animation:"slide-in-up"});f.fromTemplateUrl("iPay.html",function(D){s.ipay=D},{scope:s,animation:"slide-in-up"});var p;s.ipayClose=function(){s.ipay.hide();if(!!p){if(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)){window.history.go(-(Math.abs(JSON.parse(localStorage.getItem("h")).eid+1)))}else{window.history.go(-(Math.abs(JSON.parse(localStorage.getItem("h")).eid)))}p.src="about:blank";p.parentNode.removeChild(p)}};s.ipayOpen_w=function(D){window.location.href=""+httpUrl+"/cust/mPayOrder.action?orderPay.orderNum="+D+"&orderPay.payType=wechat_pay"};s.ipayOpen_a=function(E){s.ipay.show();p=document.createElement("iframe");document.getElementById("myFrame").appendChild(p);p.id="frame";p.src=""+httpUrl+"/cust/mPayOrder.action?orderPay.orderNum="+E+"&orderPay.payType=alipay_wap";var F=0;var D="*";var G;localStorage.setItem("h",JSON.stringify({eid:0}));p.onload=function(){var I=JSON.parse(localStorage.getItem("h")).eid;var H=parent.document.getElementById("frame").contentWindow.location.pathname;if(F===0&&D==="*"){F=1;D="+";G=window.history.length}else{if(G!==window.history.length){D="+";G=window.history.length}else{if(G===window.history.length){D="-"}}}if(D==="+"){localStorage.setItem("h",JSON.stringify({eid:++I}))}else{localStorage.setItem("h",JSON.stringify({eid:--I}))}G=window.history.length};G=window.history.length};s.removeFrame=function(){try{if(!!p){p.src="about:blank";p.parentNode.removeChild(p)}}catch(D){}};s.userLoginShowHide=function(D){D?s.userLogin.show():s.userLogin.hide();if(D===true){h.alo()}};s.userRegisterShowHide=function(D){D?s.iregister.show():s.iregister.hide()};s.editMessageShowHide=function(D){if(D===true){getOrPostRequestObj.userAndAdminSignIn.isUserLogin(s,C);g.search({page:"editMessage"}).replace();s.editContent.show()}else{g.search("").replace();s.editContent.hide()}};s.getSendMessageState=function(){return s.sendMessageIsLogin};s.isLogin_CallBack=function(D){s.sendMessageIsLogin=!!D};s.loadingImg=function(){function E(){return window.navigator.userAgent.toLowerCase().indexOf("msie")>=1}var D=E();(function(){var L=$$("mainContent");if(privateVerifictionObj.verifiction.isNotNull(L)===true&&privateVerifictionObj.verifiction.isNotNull(L.getElementsByTagName("img"))===true){var K=L.getElementsByTagName("img").length,H=[];for(var J=0,M=K;J<M;J++){var G=L.getElementsByTagName("img")[J];if(G){G.setAttribute("_lazysrc",G.getAttribute("_lazysrc")+"?"+Math.random());H.push(G)}}var I=new ImagesLazyLoad({container:window,mode:"vertical",holder:"mobileImg/nopic.jpg",onLoad:function(N){N.onload=function(){F(this)}}});function F(N){var O=setInterval(function(){var P=D?N.filters.alpha.opacity:N.style.opacity*100;if(P<100){D?N.filters.alpha.opacity+=10:N.style.opacity=(P+10)/100}else{clearInterval(O)}},15)}}})()};s.pay_callBack=function(D,E){s.setisPay(D);if(E.respData.aliWapPay==="Y"){s.setpayTypesArr_a({payName:"支付宝",payHide:false})}else{s.setpayTypesArr_a({payName:"",payHide:true})}if(E.respData.wechatPay==="Y"){s.setpayTypesArr_w({payName:"微信支付",payHide:false})}else{s.setpayTypesArr_w({payName:"",payHide:true})}if(E.respData.aliWapPay==="Y"){s.data={payType:"支付宝"}}else{if(E.respData.wechatPay==="Y"){s.data={payType:"微信支付"}}}s.payTypes_a=s.getpayTypesArr_a();s.payTypes_w=s.getpayTypesArr_w()}};iconfig.$inject=["$stateProvider","$urlRouterProvider"];indexModule.config(iconfig);indexModule.service("indexService",function(){var e={};var f=[];var b=[];var c=true;var d=true;var i=true;var a=false;var g=1;var h={};e.getSlider=function(){return f};e.setSlider=function(j){f=j};e.getNewProData=function(){return b};e.setNewProData=function(j){b=j};e.getNewProHide=function(){return c};e.setNewProHide=function(j){c=j};e.getProBtnHide=function(){return d};e.setProBtnHide=function(j){d=j};e.getMoreHide=function(){return i};e.setMoreHide=function(j){i=j};e.getLoadingHide=function(){return a};e.setLoadingHide=function(j){a=j};e.getPageNum=function(){return g};e.setPageNum=function(j){g=j};e.getProData=function(){return h};e.setProData=function(j){h=j};return e});var indexCtrl=function(n,j,l,b,d){n.newProIsHide=l.getNewProHide();n.proBtnHide=l.getProBtnHide();n.setPerSpCar(0);n.noMoreHide=l.getMoreHide();n.loadingHide=l.getLoadingHide();n.pageNum=l.getPageNum();n.banState=true;var g=true;n.$on("$stateChangeStart",function(){b.cancel(n.loadHttp)});n.indexRefresh=function(){b(function(){getOrPostRequestObj.indexConnect.getIndexBanner(n,j);getOrPostRequestObj.indexConnect.getIndexNewProduct(n,j);n.proRefresh();n.$broadcast("scroll.refreshComplete")},1000)};n.bannerInit_CallBack=function(q){l.setSlider(n.bannerReturnData(q));var u=l.getSlider();var v=[];if(document.querySelector("#indexSwiperView").querySelector("ul")){var p=document.getElementById("indexSwiperView");p.removeChild(p.getElementsByTagName("ul").item(1))}document.getElementById("indexSwiper").innerHTML="";for(var r=0,s=u.length;r<s;r++){v.push({content:"<div class='bannerImg'><img src='"+u[r].iSlideImg+"' onerror=this.src=errImg></div>"})}var e={type:"dom",data:v,dom:document.getElementById("indexSwiper"),duration:3000,isLooping:true,isAutoplay:true,onslidechange:function(i){t.changeIndexDot();n.banState=false},onslide:function(i){n.banState=false},onslidestart:function(){n.banState=true},onslideend:function(i){if(n.banState===true){if(u[i].isToUrl===0){try{window.device.version.substr(0,1);publicEventsObj.mobileEvent.webpage_mobile(u[i].content)}catch(x){window.open(u[i].content)}}else{b(function(){n.showDetailed(u[i].content)},50)}}}};if(u.length>0){var t=new iSlider(e);var w={top:"105px",width:"100%",diameter:"0.8em",borderColor:"#365b88"};t.renderDot(w)}};n.bannerReturnData=function(r){var t=[];var q=r.respData;var s={};for(var p=0,e=q.length;p<e;p++){s={iSlideImg:privateVerifictionObj.verifiction.imgLink(q[p].imgUrl),isToUrl:q[p].linkType,content:q[p].linkContent};t.push(s)}return t};n.newProInit_CallBack=function(e){l.setNewProData(n.newProReturnData(e));n.newProDatas=l.getNewProData();n.newProDatas.newIndexImgs.length===0?l.setNewProHide(true):l.setNewProHide(false);n.newProIsHide=l.getNewProHide();n.proBtnHide=false;l.setProBtnHide(false);b(function(){n.loadingImg()},500)};n.newProReturnData=function(s){var q=s.respData.dataList;var v;var t=[];var u=[];var p=[];var e=q.length;for(var r=0;r<e;r++){u.push({newProNum:q[r].prodNum,newProImg:privateVerifictionObj.verifiction.imgLink(q[r].firstProdImg)});if(r===1||e<2){p=u;u=[]}else{if((r-1)%3===0||r!==0&&r===e-1&&(e-2)%3!==0){t.push(u);u=[]}}}v={newIndexImgs:p,newProImgs:t};return v};n.toAbout=function(){d.path("/about")};n.toContact=function(){d.path("/contact")};n.toMessage=function(){d.path("/message")};n.showDetailed=function(e){if(e){d.path("/detailed").search({proNum:e,dNum:2})}};if(n.viewStates.getIndexState()===false){getOrPostRequestObj.indexConnect.getIndexBanner(n,j);getOrPostRequestObj.indexConnect.getIndexNewProduct(n,j);getOrPostRequestObj.productConnect.getProduct(n,j);n.viewStates.setIndexState(true)}else{n.newProDatas=l.getNewProData();var k=l.getSlider();var m=[];for(var c=0,f=k.length;c<f;c++){m.push({content:"<div class='bannerImg' ><img src='"+k[c].iSlideImg+"' onerror=this.src=errImg></div>"})}var a={type:"dom",data:m,dom:document.getElementById("indexSwiper"),duration:3000,isLooping:true,isDebug:false,isAutoplay:true,onslidechange:function(e){h.changeIndexDot();n.banState=false},onslide:function(e){n.banState=false},onslidestart:function(){n.banState=true},onslideend:function(e){if(n.banState===true){if(k[e].isToUrl===0){try{window.device.version.substr(0,1);publicEventsObj.mobileEvent.webpage_mobile(k[e].content)}catch(i){window.open(k[e].content)}}else{b(function(){n.showDetailed(k[e].content)},50)}}}};if(k.length>0){var h=new iSlider(a);var o={top:"105px",width:"100%",diameter:"0.8em",borderColor:"#00407a"};h.renderDot(o)}n.proDatas=l.getProData();g=false;b(function(){n.loadingImg()},500)}n.productInit_CallBack=function(e){l.setProData(n.productReturnData(e));n.proDatas=l.getProData();n.pageNum=2;l.setPageNum(2);b(function(){g=false},1000);b(function(){n.loadingImg()},500)};n.productLoadMore_CallBack=function(e){var i=n.productReturnData(e);n.proDatas.proLeftInfos=n.proDatas.proLeftInfos.concat(i.proLeftInfos);n.proDatas.proRightInfos=n.proDatas.proRightInfos.concat(i.proRightInfos);l.setProData(n.proDatas);n.pageNum++;l.setPageNum(n.pageNum);b(function(){g=false},1000);b(function(){n.loadingImg()},500)};n.productLoadMore=function(){if(n.noMoreHide&&g===false){g=true;n.loadHttp=b(function(){getOrPostRequestObj.productConnect.getProductMore(n,j);n.$broadcast("scroll.infiniteScrollComplete")},1000)}else{n.$broadcast("scroll.infiniteScrollComplete")}};n.proRefresh=function(){getOrPostRequestObj.productConnect.getProduct(n,j);n.noMoreHide=true;n.loadingHide=false;l.setMoreHide(true);l.setLoadingHide(false);n.pageNum=1;l.setPageNum(1)};n.productReturnData=function(r){var z,t,v,s,y=[],e=[],x=r.respData.dataList;var w=document.getElementsByClassName("indexImgLayout")[0].offsetHeight;var i=document.getElementsByClassName("indexImgLayout")[1].offsetHeight;for(var p=0,u=x.length;p<u;p+=2){v={proNum:x[p].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(x[p].firstProdImg),proName:x[p].prodName,proPrice:"¥"+x[p].stdPrice};if(p+1<u){s={proNum:x[p+1].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(x[p+1].firstProdImg),proName:x[p+1].prodName,proPrice:"¥"+x[p+1].stdPrice}}if(i<w||i==w){t=v;e.push(t);if(p+1<u){z=s;y.push(z)}}else{z=v;y.push(z);if(p+1<u){t=s;e.push(t)}}}var q={proLeftInfos:y,proRightInfos:e};if(x.length<14){n.noMoreHide=false;n.loadingHide=true;l.setMoreHide(false);l.setLoadingHide(true)}return q};n.proLeftClick=function(e){d.path("/detailed").search({proNum:n.proDatas.proLeftInfos[e].proNum,dNum:2})};n.proRightClick=function(e){d.path("/detailed").search({proNum:n.proDatas.proRightInfos[e].proNum,dNum:2})}};imainCtrl.$inject=["$rootScope","$sce","$scope","$http","$location","$timeout","$ionicPopup","$ionicPopover","$ionicModal","$ionicBackdrop","$ionicHistory"];indexModule.controller("mainCtrl",imainCtrl);indexModule.service("aboutService",function(){var b={};var a="";var c="";b.getAboutImg=function(){return a};b.setAboutImg=function(d){a=d};b.getAboutText=function(){return c};b.setAboutText=function(d){c=d};return b});var aboutCtrt=function(a,d,c,b){a.aboutInit_CallBack=function(f){var e=a.aboutReturnData(f);a.iAboutImg=e.img;a.iAboutText=e.contentText;c.setAboutImg(e.img);c.setAboutText(e.contentText);b(function(){a.loadingImg()},500)};a.aboutReturnData=function(k){var j=k.respData,g="",f=j.introduction.replace(/\./g,"。").split("。");for(var h=0,e=f.length;h<e;h++){g+="<p>"+f[h]+"</p>"}return{contentText:g,img:privateVerifictionObj.verifiction.imgLink(j.ownerImg)}};if(a.viewStates.getAboutState()===false){getOrPostRequestObj.orderInfoConnect.getAboutInfo(a,d);a.viewStates.setAboutState(true)}else{a.iAboutImg=c.getAboutImg();a.iAboutText=c.getAboutText()}};indexCtrl.$inject=["$scope","$http","indexService","$timeout","$location"];var indexCtrlarr=["$scope","$http","indexService","$timeout","$location",indexCtrl];indexModule.controller("index",indexCtrlarr);indexModule.service("categoryService",function(){var a={};var b="";var c="";var d=true;a.getMenuDatas=function(){return b};a.setMenuDatas=function(e){b=e};a.getCateSearchText=function(){return c};a.setCateSearchText=function(e){c=e};a.getClearBtnShow=function(){return d};a.setClearBtnShow=function(e){d=e};return a});var categoryCtrl=function(a,d,b,c){a.clearBtnShow=b.getClearBtnShow();a.catePro={searchText:b.getCateSearchText()};a.setIState(false);a.$on("$stateChangeStart",function(f,e){if(e.name==="product"){if(a.getProduct()!==0&&a.getCategory()!==0&&a.getIState()===false){a.setProduct(1);a.setCategory(0)}}else{if(e.name==="shoppingCar"||e.name==="personal"){if(a.getProduct()!==0||a.getCategory()!==0){a.setProduct(0);a.setCategory(0)}}}});a.OpenOrCloseMenu=function(e){if(a.menuDatas[e].menuBarOff===false&&a.menuDatas[e].menuBarOn===false){a.viewStates.setSearchResListState(false);c.path("/searchRes").search({name:a.menuDatas[e].itemDatas[0].itemData,id:a.menuDatas[e].itemDatas[0].itemId,type:0})}else{a.menuDatas[e].itemHide=!a.menuDatas[e].itemHide;a.menuDatas[e].menuBarOff=!a.menuDatas[e].menuBarOff;a.menuDatas[e].menuBarOn=!a.menuDatas[e].menuBarOn;if(a.menuDatas[e].itemDatas.length>0){a.menuDatas[e].menuHeaderShow=!a.menuDatas[e].menuHeaderShow;a.menuDatas[e].menuHeaderHide=!a.menuDatas[e].menuHeaderHide}}};a.cateSearchChange=function(){a.clearBtnShow=!(a.catePro.searchText!==""&&a.catePro.searchText!==undefined);b.setCateSearchText(a.catePro.searchText);b.setClearBtnShow(a.clearBtnShow)};a.clearData=function(){a.catePro.searchText="";a.clearBtnShow=true;b.setCateSearchText(a.catePro.searchText);b.setClearBtnShow(a.clearBtnShow)};a.searchPro=function(){if(privateVerifictionObj.verifiction.isNotNull(a.catePro.searchText)===true){a.viewStates.setSearchResListState(false);c.path("/searchRes").search({name:a.catePro.searchText,id:"",type:"1"})}};a.searchCate=function(f,e){a.viewStates.setSearchResListState(false);c.path("/searchRes").search({name:f,id:e,type:0})};a.categoryInit_CallBack=function(e){a.menuDatas=a.categoryReturnData(e);b.setMenuDatas(a.menuDatas)};a.categoryReturnData=function(n){var h=[];var q=n.respData;var r={};var e="";var k=[];for(var o=0,p=q.length;o<p;o++){if(q[o].childProdCatHiers.length>0){for(var l=0,f=q[o].childProdCatHiers.length;l<f;l++){if(q[o].childProdCatHiers[l].childProdCatHiers.length>0){for(var g=0,s=q[o].childProdCatHiers[l].childProdCatHiers.length;g<s;g++){if(g===0){e=q[o].childProdCatHiers[l].prodCat.prodCatName}k.push({itemId:q[o].childProdCatHiers[l].childProdCatHiers[g].prodCat.prodCatId,itemData:q[o].childProdCatHiers[l].childProdCatHiers[g].prodCat.prodCatName})}r={itemHead:e,itemDatas:k,menuBarOff:true,menuBarOn:false,menuHeaderShow:false,menuHeaderHide:true,itemHide:true};h.push(r);e="";k=[];r={}}else{if(l===0){e=q[o].prodCat.prodCatName}k.push({itemId:q[o].childProdCatHiers[l].prodCat.prodCatId,itemData:q[o].childProdCatHiers[l].prodCat.prodCatName})}}r={itemHead:e,itemDatas:k,menuBarOff:true,menuBarOn:false,menuHeaderShow:false,menuHeaderHide:true,itemHide:true};if(e!==""){h.push(r)}e="";k=[];r={}}else{e=q[o].prodCat.prodCatName;r={itemHead:e,itemDatas:[{itemId:q[o].prodCat.prodCatId,itemData:q[o].prodCat.prodCatName}],menuBarOff:false,menuBarOn:false,menuHeaderShow:false,menuHeaderHide:true,itemHide:true};h.push(r)}}return h};if(a.viewStates.getCategoryState()===false){getOrPostRequestObj.proSearchConnec.proMenuIconLayout(a,d);a.viewStates.setCategoryState(true)}else{a.menuDatas=b.getMenuDatas()}};aboutCtrt.$inject=["$scope","$http","aboutService","$timeout"];var aboutCtrlarr=["$scope","$http","aboutService","$timeout",aboutCtrt];indexModule.controller("about",aboutCtrlarr);indexModule.service("contactService",function(){var f={};var c="";var g="";var e="";var b="";var a="";var i="";var h="";var d="javascript:void(0)";f.getCompanyName=function(){return c};f.setCompanyName=function(j){c=j};f.getAddress=function(){return g};f.setAddress=function(j){g=j};f.getWebSite=function(){return e};f.setWebSite=function(j){e=j};f.getContactPerson=function(){return b};f.setContactPerson=function(j){b=j};f.getPhoneNum=function(){return a};f.setPhoneNum=function(j){a=j};f.getLongiTude=function(){return i};f.setLongiTude=function(j){i=j};f.getLatiTude=function(){return h};f.setLatiTude=function(j){h=j};f.getPhoneNumBtn=function(){return d};f.setPhoneNumBtn=function(j){d=j};return f});var contcatCtrl=function(a,d,c,b){a.contactInit_CallBack=function(f){var e=a.contactReturnData(f);a.companyName=e.companyName;a.address=e.address;a.webSite=e.webSite;a.contactPerson=e.contactPerson;a.phoneNum=e.phoneNum;c.setCompanyName(e.companyName);c.setAddress(e.address);c.setWebSite(e.webSite);c.setContactPerson(e.contactPerson);c.setPhoneNum(e.phoneNum)};a.phoneBtn_CallBack=function(e){c.setPhoneNumBtn(e)};a.callPhone=function(){window.location.href=c.getPhoneNumBtn()};a.contactReturnData=function(f){var e=f.respData;b(function(){a.mapInit(e.longitude,e.latitudes)},500);c.setLongiTude(e.longitude);c.setLatiTude(e.latitudes);return{companyName:e.companyName,address:e.address,contactPerson:e.contactPerson,webSite:e.webSite,phoneNum:e.phoneNum}};a.mapInit=function(k,j){var i=new BMap.Map("contenttexts"),g=new BMap.Icon("mobileImg/icon.png",new BMap.Size(50,50),{anchor:new BMap.Size(30,28)}),e=new BMap.Point(k,j),f=new BMap.Marker(e,{icon:g});i.centerAndZoom(e,16);i.addControl(new BMap.ZoomControl());i.addOverlay(f);var h=new BMap.TrafficLayer();i.addTileLayer(h);i.setZoom(18)};if(a.viewStates.getContactState()===false){getOrPostRequestObj.orderInfoConnect.getContactInfo(a,d);if(privateVerifictionObj.verifiction.isMobile()===true){getOrPostRequestObj.indexConnect.initPhoneBtn(a,d)}a.viewStates.setContactState(true)}else{a.mapInit(c.getLongiTude(),c.getLatiTude());a.companyName=c.getCompanyName();a.address=c.getAddress();a.webSite=c.getWebSite();a.contactPerson=c.getContactPerson();a.phoneNum=c.getPhoneNum()}};categoryCtrl.$inject=["$scope","$http","categoryService","$location"];var categoryarr=["$scope","$http","categoryService","$location",categoryCtrl];indexModule.controller("category",categoryarr);indexModule.service("detaiService",function(){var a={};var b=0;a.getDNum=function(){return b};a.setDNum=function(c){b=c};return a});var detailedCtrl=function(k,c,h,b,d){var f="";var a="";k.shoppingType=0;k.detailed={proNum:0};k.selState="请选择 商品分类";k.addText="加入购物车";k.open=false;k.open_dis=false;var e=-1;var j=d.search().dNum;var l=k.getProduct();var i=k.getCategory();k.setCategory(0);k.setProduct(0);if(privateVerifictionObj.verifiction.isNotNull(j)===true){if(k.getPerSpCar()>=2){k.setPerSpCar(k.getPerSpCar()+j)}else{k.setIsDetailed(j)}c.setDNum(j)}else{j=c.getDNum()}var g=d.search().hisPage;d.search({proNum:d.search().proNum,hisPage:d.search().hisPage}).replace();k.cartHide=g==1;k.detailedInit_CallBack=function(o){var u=k.detailedReturnData(o);k.detailedDatas=u;var t=document.createElement("div");t.innerHTML=k.detailedDatas.remark;for(var p=0,q=t.getElementsByTagName("img").length;p<q;p++){t.getElementsByTagName("img")[p].removeAttribute("height")}k.detailedDatas.remark=t.innerHTML;t="";for(var p=0,q=o.prodExternals.length;p<q;p++){if(o.prodExternals[p].externalName==="murl"){a=o.prodExternals[p].externalValue}else{f=o.prodExternals[p].externalValue}}try{if(privateVerifictionObj.verifiction.isNotNull(o.prodExternals[0].externalValue)===true){k.isToAl=o.prodExternals[0].externalValue.substring(0,4)==="http"}else{k.isToAl=false}}catch(s){k.isToAl=false}var v=u.islides;var w=[];document.getElementById("detailedSwiper").innerHTML="";for(var n=0,x=v.length;n<x;n++){w.push({content:"<div class='detailed_bannerImg' ><img src='"+v[n].iSlideImg+"' onerror=this.src=errImg></div>"})}var m={type:"dom",data:w,dom:document.getElementById("detailedSwiper"),duration:3000,isLooping:true,isAutoplay:true,onslidechange:function(z){r.changeIndexDot()}};if(v.length>0){var r=new iSlider(m);var y={top:"42%",width:"100%",diameter:"0.8em",borderColor:"#365b88"};r.renderDot(y)}};k.detailedReturnData=function(v){var s,y=v,w=[],o=[],z=[],x="",n="",A="";for(var u=0,q=y.prodImgs.length;u<q;u++){x=privateVerifictionObj.verifiction.imgLink(y.prodImgs[u].thumbUrl);o.push({iSlideImg:x})}for(var t=0,B=y.prodFeatures.length;t<B;t++){n=y.prodFeatures[t].featureName;A=y.prodFeatures[t].ifeatureValue;w.push({extFeatrue:n+": "+A})}for(var r=0,p=y.prodDiffers.length;r<p;r++){z.push({dName:y.prodDiffers[r].differName,dState:false})}s={detailedTitle:y.prodName,islides:o,typeNames:z,price:"¥"+y.stdPrice,balance:y.dispStockBalance,extFeatrue:w,data:y.createDate,remark:y.remark,external:y.prodExternals};return s};k.$on("$stateChangeStart",function(n,m){getOrPostRequestObj.userAndAdminSignIn.isToShoppingCar=false;k.addText="加入购物车";k.selState="请选择 商品分类";k.open=false;k.open_dis=false;e=-1;if(m.name!=="shoppingCar"){if(m.name!=="index"){k.setProduct(l);k.setCategory(i);if(privateVerifictionObj.verifiction.isNotNull(j)===true){if(k.getPerSpCar()>=2){k.setPerSpCar(k.getPerSpCar()-j)}else{k.setIsDetailed(-j)}}}}if(m.name==="myOrder"||m.name==="superPro"){k.setPerSpCar(0)}if(m.name!=="searchRes"){k.viewStates.setSearchResListState(false)}});k.$on("$stateChangeSuccess",function(n,m){if(m.name==="detailed"){if(d.search().proNum!==""){k.cqcsHide=false;getOrPostRequestObj.detailedConnect.getDetailed(d.search().proNum,k,h)}else{k.cqcsHide=true;k.detailedDatas={detailedTitle:"产品获取失败，请返回重新选择产品。"}}}});k.iaddToShoppinCar=function(){if(k.detailedDatas.typeNames.length>0){if(e!=-1){publicEventsObj.operatingDatabaseEvent.insertData(d.search().proNum,1,k.selState,k)}else{if(k.addText==="确定"){k.showAlert("提 示","请选择商品属性!")}else{k.addText="确定";k.open_dis=true;k.open=true}}}else{publicEventsObj.operatingDatabaseEvent.insertData(d.search().proNum,1,"默认",k)}};k.toShopCar=function(){d.path("/shoppingCar")};k.iToAlbb=function(){if(privateVerifictionObj.verifiction.isMobile()){try{window.device.version.substr(0,1);publicEventsObj.mobileEvent.webpage_mobile(a)}catch(m){window.open(a)}}else{window.open(f)}};k.selType=function(m){if(e!=-1){k.detailedDatas.typeNames[e].dState=false}e=m;k.detailedDatas.typeNames[m].dState=true;k.selState=k.detailedDatas.typeNames[m].dName};k.closeSelType=function(){k.open=false;b(function(){k.open_dis=false},500);k.addText="加入购物车";k.selState="请选择 商品分类";if(e!=-1){k.detailedDatas.typeNames[e].dState=false;e=-1}};getOrPostRequestObj.userAndAdminSignIn.isUserLogin(k,h)};contcatCtrl.$inject=["$scope","$http","contactService","$timeout"];var contactarr=["$scope","$http","contactService","$timeout",contcatCtrl];indexModule.controller("contact",contactarr);var editMessage=function(b,c,a){b.charNum=80;b.toUserLogin=function(){b.userLoginShowHide(true)};b.hideEditMessage=function(){b.editMessageShowHide(false)};b.sendMessage=function(){b.iMeassage=angular.element(document.querySelector("#messageId")).val();if(privateVerifictionObj.verifiction.isNotNull(b.iMeassage)===true){getOrPostRequestObj.messageConnect.sendMessage(b,c)}else{b.showAlert("提 示","留言内容不能为空!")}};b.sendMessageDone_CallBack=function(){var e={name:b.getSendMessageState()?publicParameterObj.parameters.userName.substr(0,5)+"******":"匿名账户",createData:"刚刚",messageContent:b.iMeassage};var d=b.getMessage();d.splice(0,0,e);b.setMessage(d.splice(0,d.length,e));b.iMeassage="";angular.element(document.querySelector("#messageId")).val("");a.setMessageDatas(b.iMessageDatas);b.editMessageShowHide(false);b.viewStates.setMessageState(false)}};indexModule.directive("eventVal",function(){return{require:"ngModel",scope:false,link:function(b,d,a,c){c.$parsers.push(function(e){b.charNum=80-e.length})}}});detailedCtrl.$inject=["$scope","detaiService","$http","$timeout","$location"];var detailedarr=["$scope","detaiService","$http","$timeout","$location",detailedCtrl];indexModule.controller("detailed",detailedarr);editMessage.$inject=["$scope","$http","messageService"];var editMessagearr=["$scope","$http","messageService",editMessage];indexModule.controller("editMessageCtrl",editMessagearr);indexModule.service("messageService",function(){var a={};var d=[];var e=true;var c=false;var b=1;a.getMessageDatas=function(){return d};a.setMessageDatas=function(f){d=f};a.getMoreHide=function(){return e};a.setMoreHide=function(f){e=f};a.getLoadingHide=function(){return c};a.setLoadingHide=function(f){c=f};a.getPageNum=function(){return b};a.setPageNum=function(f){b=f};return a});var messageCtrl=function(c,g,b,a,f,d){c.editMessageIsLogin=false;c.noMoreHide=b.getMoreHide();c.loadingHide=b.getLoadingHide();c.pageNum=b.getPageNum();c.pageNum=b.getPageNum();var e=true;c.$on("$stateChangeStart",function(){c.editMessageShowHide(false);d.cancel(c.loadHttp)});c.messageInit_CallBack=function(h){b.setMessageDatas(c.messageReturnData(h));c.setMessage(b.getMessageDatas());c.pageNum=2;b.setPageNum(2);d(function(){e=false},1000)};c.messageLoadMore_CallBack=function(i){var h=c.messageReturnData(i);c.setMessage(c.getMessage().concat(h));c.pageNum++;b.setPageNum(c.pageNum);b.setMessageDatas(c.getMessage());d(function(){e=false},1000)};c.showEditMessage=function(){c.editMessageShowHide(true)};c.messageLoadMore=function(){if(c.noMoreHide&&e===false){e=true;c.loadHttp=d(function(){getOrPostRequestObj.messageConnect.messageLoadMore(c,g);c.$broadcast("scroll.infiniteScrollComplete")},1000)}else{c.$broadcast("scroll.infiniteScrollComplete")}};c.messageReturnData=function(l){var n=[],k=l.respData.dataList,m;for(var j=0,h=k.length;j<h;j++){m={name:k[j].createBy===""||k[j].createBy===undefined?"匿名账户":k[j].createBy.substr(0,5)+"******",createData:k[j].createDate.replace("T"," "),messageContent:k[j].content};n.push(m)}if(k.length<14){c.noMoreHide=false;c.loadingHide=true;b.setMoreHide(false);b.setLoadingHide(true)}return n};if(c.viewStates.getMessageState()===false){getOrPostRequest.messageConnect.getMessage(c,g);c.viewStates.setMessageState(true)}else{c.setMessage(b.getMessageDatas());e=false}};var myOrderCtrl=function(a,e,d,b){a.custName="未登录";a.noMoreHide=true;a.loadingHide=false;a.pageNum=2;var c=true;a.$on("$stateChangeStart",function(g,f){b.cancel(a.loadHttp)});a.$on("$stateChangeSuccess",function(g,f){if(f.name==="myOrder"){b(function(){getOrPostRequestObj.userAndAdminSignIn.isUserLogin(a,e)},450);getOrPostRequestObj.myOrderConnect.userShowOrderList(a,e)}});a.myOrderInit_CallBack=function(f){a.oLists=a.myOrderReturnData(f);a.pageNum=2;b(function(){c=false},1000);b(function(){a.loadingImg()},500)};a.myOrderLoadMore_CallBack=function(g){var f=a.myOrderReturnData(g);a.oLists=a.oLists.concat(f);a.pageNum++;b(function(){c=false},1000);b(function(){a.loadingImg()},500)};a.myOrederLoadMore=function(){if(a.noMoreHide&&c===false){a.loadHttp=b(function(){c=true;getOrPostRequestObj.myOrderConnect.userMyOrderLoadMore(a,e);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.isLogin_CallBack=function(f){if(f===true){a.custName=publicParameterObj.parameters.userName}else{a.custName="未登录"}};a.myOrderReturnData=function(p){var w={};var r=[];var l=[];var k={};var x=[];var h=[];var v=p.respData.dataList;var n=true;var f=true;var q,t,u;for(var o=0,s=v.length;o<s;o++){n=true;f=true;q=false;t=false;u=false;for(var m=0,g=v[o].orderItemList.length;m<g;m++){k={proId:v[o].orderItemList[m].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(v[o].orderItemList[m].whereimg),proName:v[o].orderItemList[m].prodName,proNum:"订购数量: "+v[o].orderItemList[m].cases,proPrice:"¥"+v[o].orderItemList[m].custProdPrice,proType:v[o].orderItemList[m].differName};if(m<3){r.push(k)}else{n=true;f=false;l.push(k)}k={}}switch(v[o].deliverStatus){case 0:q=true;break;case 1:t=true;break;case 2:u=true;break}w={orderId:v[o].orderNum,isProHide:n,isHide:f,oItems:x,oPros:r,oHidePro:l,orderState:v[o].deliverStatusName,orderAddr:(privateVerifictionObj.verifiction.isNotNull(v[o].deliverAddr)===true)?v[o].deliverAddr:"",date:v[o].createDate,oCountNum:v[o].orderItemList.length,oCountPrice:"¥"+v[o].custPriceTotal,payStatus:v[o].onlinePayStatus,btnText:"显示全部",stateRed:q,stateBlue:t,stateGray:u};h.push(w);x=[];r=[];l=[]}if(v.length<9){a.noMoreHide=false;a.loadingHide=true}return h};a.toDetailed=function(f){var g=a.getPerSpCar()+4;a.setPerSpCar(g);d.path("/detailed").search({proNum:f})};a.hideShowPro=function(f){a.oLists[f].isProHide=!a.oLists[f].isProHide;a.oLists[f].isProHide?a.oLists[f].btnText="显示全部":a.oLists[f].btnText="隐藏部分"};a.topay=function(f){d.path("/payType").search({oId:f})}};messageCtrl.$inject=["$scope","$http","messageService","$ionicModal","$location","$timeout"];var messageCtrlarr=["$scope","$http","messageService","$ionicModal","$location","$timeout",messageCtrl];indexModule.controller("message",messageCtrlarr);var ipayCtrl=function(a,b){a.$on("$stateChangeStart",function(){a.removeFrame();a.ipay.hide()})};var payTypeCtrl=function(a,d,c){var b=c.search().oId;a.settingPayType=function(e){switch(e){case"支付宝":a.ipayOpen_a(b);break;case"微信支付":a.ipayOpen_w(b);break}}};ipayCtrl.$inject=["$scope","$http","$location"];indexModule.controller("iPay",ipayCtrl);payTypeCtrl.$inject=["$scope","$http","$location"];indexModule.controller("payType",payTypeCtrl);indexModule.service("perService",function(){var a={};var c="未登录";var b="";a.getUserName=function(){return c};a.setUserName=function(d){c=d};a.getUserCompany=function(){return b};a.setUserCompany=function(d){b=d};return a});var personalCtrl=function(a,b,g,f,d,c,e){b.useriName=f.getUserName();b.useriCompany=f.getUserCompany();b.setPerSpCar(0);b.$on("$stateChangeStart",function(){if(b.perConfirm){b.perConfirm.close()}});b.$on("$stateChangeSuccess",function(i,h){if(h.name==="personal"){if(b.viewStates.getPersonalState()===false){c(function(){getOrPostRequestObj.registConnect.userLoginInfo(b,g)},500)}}});b.showConfirm=function(){b.perConfirm=d.confirm({title:"提 示",content:"您确定要退出登录吗?",buttons:[{text:"取 消",type:"alertCancel",onTap:function(h){return false}},{text:"确 定",type:"alertComfirm",onTap:function(h){return true}}]});b.perConfirm.then(function(h){if(h){b.viewStates.setPersonalState(false);f.setUserName("未登录");f.setUserCompany("");b.useriName="未登录";b.useriCompany="";getOrPostRequestObj.userAndAdminSignIn.userLoginOut(b,g);b.viewStates.setShoppingCarState(false);localStorage.setItem("sc",false);localStorage.setItem("ac",false);localStorage.setItem("ac",false);localStorage.setItem("userName","");a.cancelAutoSave()}else{}})};b.perList=function(h){switch(h){case 0:e.path("/shoppingCar").search("");b.setPerSpCar(2);break;case 1:e.path("/myOrder").search("");b.setPerSpCar(0);break;case 2:e.path("/superPro").search("");b.setPerSpCar(0);break;case 3:e.path("/modifyPass").search("");b.setPerSpCar(0);break;case 4:e.path("/modifyInfo").search("");b.setPerSpCar(0);break}};b.userLoginOut=function(){b.showConfirm()};b.infoInit_CallBack=function(h){b.useriName=h.respData.custName;b.useriCompany=h.respData.companyName;f.setUserName(h.respData.custName);f.setUserCompany(h.respData.companyName);b.viewStates.setPersonalState(true)}};myOrderCtrl.$inject=["$scope","$http","$location","$timeout"];indexModule.controller("myOrder",myOrderCtrl);indexModule.service("productService",function(){var i={};var k=true;var a=false;var c="";var j=1;var b={};var l="";var h=false;var d=0;var g=false;var f="";var e="";i.getMoreHide=function(){return k};i.setMoreHide=function(m){k=m};i.getLoadingHide=function(){return a};i.setLoadingHide=function(m){a=m};i.getSearchText=function(){return c};i.setSearchText=function(m){c=m};i.getPageNum=function(){return j};i.setPageNum=function(m){j=m};i.getProData=function(){return b};i.setProData=function(m){b=m};i.getSearchTextSave=function(){return l};i.setSearchTextSave=function(m){l=m};i.getIShowType=function(){return h};i.setIShowType=function(m){h=m};i.getSortingState=function(){return d};i.setSortingState=function(m){d=m};i.getIsUpSorting=function(){return g};i.setIsUpSorting=function(m){g=m};i.getSortType=function(){return f};i.setSortType=function(m){f=m};i.getSortBy=function(){return e};i.setSortBy=function(m){e=m};return i});var productCtrl=function(b,h,a,g,c,d){b.noMoreHide=a.getMoreHide();b.loadingHide=a.getLoadingHide();b.searchEvt=null;b.pageNum=a.getPageNum();b.iPro={searchText:a.getSearchText()};b.showType=a.getIShowType();b.sortingState=a.getSortingState();b.isUpSorting=a.getIsUpSorting();b.sortType="";b.sortBy="";var f=a.getSearchTextSave();var e=true;b.setIState(false);b.$on("$stateChangeStart",function(j,i){d.cancel(b.loadHttp);if(i.name==="category"){if(b.getCategory()!==0&&b.getProduct()!==0&&b.getIState()===false){b.setProduct(0);b.setCategory(1)}}else{if(i.name==="shoppingCar"||i.name==="personal"){if(b.getProduct()!==0||b.getCategory()!==0){b.setProduct(0);b.setCategory(0)}}}});b.productInit_CallBack=function(i){a.setProData(b.productReturnData(i));b.proDatas=a.getProData();b.proResList=a.getProData().idataList;b.pageNum=2;a.setPageNum(2);d(function(){e=false},1000);d(function(){b.loadingImg()},500)};b.productLoadMore_CallBack=function(j){var i=b.productReturnData(j);b.proDatas.proLeftInfos=b.proDatas.proLeftInfos.concat(i.proLeftInfos);b.proDatas.proRightInfos=b.proDatas.proRightInfos.concat(i.proRightInfos);b.proResList=b.proDatas.idataList=b.proResList.concat(i.idataList);a.setProData(b.proDatas);b.pageNum++;a.setPageNum(b.pageNum);d(function(){e=false},1000);d(function(){b.loadingImg()},500)};b.searchResLoadMore_CallBack=function(i){b.productInit_CallBack(i)};b.productLoadMore=function(){if(b.noMoreHide&&e===false){e=true;b.loadHttp=d(function(){getOrPostRequestObj.productConnect.getProductMore(b,h);b.$broadcast("scroll.infiniteScrollComplete")},1000)}else{b.$broadcast("scroll.infiniteScrollComplete")}};b.proRefresh=function(){d(function(){getOrPostRequestObj.productConnect.getProduct(b,h);b.$broadcast("scroll.refreshComplete");b.noMoreHide=true;b.loadingHide=false;a.setMoreHide(true);a.setLoadingHide(false);b.pageNum=1;a.setPageNum(1);b.iPro.searchText="";a.setSearchText("")},1000)};b.productReturnData=function(p){var y,r,x=[],j=[],t,q,w=p.respData.dataList,n="",l=[];tempporarySpace={};tempporarySpace1={};var v;var k;try{v=document.getElementsByClassName("proImgLayout")[0].offsetHeight;k=document.getElementsByClassName("proImgLayout")[1].offsetHeight}catch(u){}for(var o=0,s=w.length;o<s;o+=2){t={proNum:w[o].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(w[o].firstProdImg),proName:w[o].prodName,proPrice:"¥"+w[o].stdPrice};if(w[o].featureName===null||w[o].featureName===undefined){n=""}else{n=w[o].featureName}tempporarySpace1={proId:w[o].prodNum,proListImg:privateVerifictionObj.verifiction.imgLink(w[o].firstProdImg),proName:w[o].prodName,proModel:"产品型号: "+n,proPrice:"¥"+w[o].stdPrice};if(o+1<s){q={proNum:w[o+1].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(w[o+1].firstProdImg),proName:w[o+1].prodName,proPrice:"¥"+w[o+1].stdPrice};if(w[o+1].featureName===null||w[o+1].featureName===undefined){n=""}else{n=w[o+1].featureName}tempporarySpace={proId:w[o+1].prodNum,proListImg:privateVerifictionObj.verifiction.imgLink(w[o+1].firstProdImg),proName:w[o+1].prodName,proModel:"产品型号: "+n,proPrice:"¥"+w[o+1].stdPrice}}if((k<v||k==v)&&k!==undefined){if(privateVerifictionObj.verifiction.isNotNull(q)===true){var p=q;q=t;t=p}r=t;j.push(r);l.push(tempporarySpace1);if(o+1<s){y=q;x.push(y);l.push(tempporarySpace)}}else{if(k===undefined&&v===undefined){if(b.proDatas.proLeftInfos.length>b.proDatas.proRightInfos){r=t;j.push(r);l.push(tempporarySpace1);if(o+1<s){y=q;x.push(y);l.push(tempporarySpace)}}else{y=t;x.push(y);l.push(tempporarySpace1);if(o+1<s){r=q;j.push(r);l.push(tempporarySpace)}}}else{y=t;x.push(y);l.push(tempporarySpace1);if(o+1<s){r=q;j.push(r);l.push(tempporarySpace)}}}}var m={proLeftInfos:x,proRightInfos:j,idataList:l};if(w.length<14){b.noMoreHide=false;b.loadingHide=true;a.setMoreHide(false);a.setLoadingHide(true)}return m};b.proSearchTextChange=function(){a.setSearchText(b.iPro.searchText)};b.iProSearch=function(){if(b.iPro.searchText!==f){b.pageNum=1;a.setPageNum(1);b.loadingHide=false;b.noMoreHide=true;a.setMoreHide(true);a.setLoadingHide(false);getOrPostRequestObj.proSearchConnec.userSearchMore(b.iPro.searchText,"",b,h);a.setSearchText(b.iPro.searchText);f=b.iPro.searchText;a.setSearchTextSave(b.iPro.searchText);e=true}};b.proLeftClick=function(i){g.path("/detailed").search({proNum:b.proDatas.proLeftInfos[i].proNum,dNum:2+b.getProduct()+b.getCategory()})};b.proRightClick=function(i){g.path("/detailed").search({proNum:b.proDatas.proRightInfos[i].proNum,dNum:2+b.getProduct()+b.getCategory()})};b.resItemClick=function(i){g.path("/detailed").search({proNum:b.proResList[i].proId,dNum:2+b.getProduct()+b.getCategory()})};b.changeStyle=function(){b.showType=!b.showType;a.setIShowType(b.showType);if(b.timeEvt){d.cancel(b.timeEvt)}b.timeEvt=d(function(){b.loadingImg()},500)};b.sortingBtnC=function(i){b.noMoreHide=true;b.loadingHide=false;a.setMoreHide(true);a.setLoadingHide(false);switch(i){case"default":if(b.sortingState!=0){b.sortingState=0;a.setSortingState(0);b.sortType="";b.sortBy="";a.setSortType("");a.setSortBy("");getOrPostRequestObj.productConnect.getProduct(b,h)}break;case"price":b.sortBy="stdPrice";if(b.sortingState==1){b.isUpSorting=!b.isUpSorting;a.setIsUpSorting(b.isUpSorting)}if(b.sortingState!=1){b.sortingState=1;a.setSortingState(1)}if(b.isUpSorting){b.sortType="asc"}else{b.sortType="desc"}a.setSortType(b.sortType);a.setSortBy(b.sortBy);getOrPostRequestObj.productConnect.getProduct(b,h);break}};if(b.viewStates.getProductState()===false){getOrPostRequestObj.productConnect.getProduct(b,h);b.viewStates.setProductState(true)}else{b.proDatas=a.getProData();b.proResList=a.getProData().idataList;b.sortType=a.getSortType();b.sortBy=a.getSortBy();e=false;d(function(){b.loadingImg()},500)}};personalCtrl.$inject=["$rootScope","$scope","$http","perService","$ionicPopup","$timeout","$location"];var personalarr=["$rootScope","$scope","$http","perService","$ionicPopup","$timeout","$location",personalCtrl];indexModule.controller("personal",personalarr);indexModule.service("proListService",function(){var a={};var f=false;var g=true;var c=1;var b="";var e="";var d="";a.getLoadingHide=function(){return f};a.setLoadingHide=function(h){f=h};a.getMoreHide=function(){return g};a.setMoreHide=function(h){g=h};a.getPageNum=function(){return c};a.setPageNum=function(h){c=h};a.getProListDatas=function(){return b};a.setProListDatas=function(h){b=h};a.getSearchText=function(){return e};a.setSearchText=function(h){e=h};a.getSearchTextSave=function(){return d};a.setSearchTextSave=function(h){d=h};return a});productCtrl.$inject=["$scope","$http","productService","$location","$ionicSideMenuDelegate","$timeout"];var productarr=["$scope","$http","productService","$location","$ionicSideMenuDelegate","$timeout",productCtrl];indexModule.controller("product",productarr);indexModule.service("searchResService",function(){var b={};var c="";var f=true;var e=false;var d=2;var a=false;b.getProResList=function(){return c};b.setProResList=function(g){c=g};b.getMoreHide=function(){return f};b.setMoreHide=function(g){f=g};b.getLoadingHide=function(){return e};b.setLoadingHide=function(g){e=g};b.getPageNum=function(){return d};b.setPageNum=function(g){d=g};b.getShowType=function(){return a};b.setShowType=function(g){a=g};return b});var searchResCtrl=function(i,f,g,c,a){var b=c.search().name,h=c.search().id,e=!!c.search().type?parseInt(c.search().type):!!c.search().type;i.noMoreHide=g.getMoreHide();i.loadingHide=g.getLoadingHide();i.resTitle=b;i.pageNum=g.getPageNum();i.showType=g.getShowType();i.proDatas={proLeftInfos:[],proRightInfos:[]};i.timeEvt=null;var d=true;i.$on("$stateChangeStart",function(k,j){a.cancel(i.loadHttp);if(j.name!=="detailed"){i.viewStates.setSearchResListState(false)}});i.showSearchResInit_CallBack=function(k){i.noMoreHide=true;i.loadingHide=false;g.setMoreHide(true);g.setLoadingHide(false);var j=i.proResReturnData(k);g.setProResList(j);i.proResList=g.getProResList().idataList;i.proDatas.proLeftInfos=g.getProResList().proLeftInfos;i.proDatas.proRightInfos=g.getProResList().proRightInfos;i.pageNum=2;g.setPageNum(2);a(function(){d=false},1000);a(function(){i.loadingImg()},500)};i.searchResLoadMore_CallBack=function(l){var k=i.proResReturnData(l);var j={};j.idataList=g.getProResList().idataList.concat(k.idataList);j.proLeftInfos=g.getProResList().proLeftInfos.concat(k.proLeftInfos);j.proRightInfos=g.getProResList().proRightInfos.concat(k.proRightInfos);i.proResList=j.idataList;i.pageNum++;g.setPageNum(i.pageNum);g.setProResList(j);i.proDatas.proLeftInfos=j.proLeftInfos;i.proDatas.proRightInfos=j.proRightInfos;a(function(){d=false},1000);a(function(){i.loadingImg()},500)};i.proResLoadMore=function(){if(i.noMoreHide&&d===false){d=true;i.loadHttp=a(function(){if(e===0||e===false){getOrPostRequestObj.proSearchConnec.userSearchMore("",h,i,f)}else{getOrPostRequestObj.proSearchConnec.userSearchMore(b,"",i,f)}i.$broadcast("scroll.infiniteScrollComplete")},1000)}else{i.$broadcast("scroll.infiniteScrollComplete")}};i.proResReturnData=function(A){var x,n,q=[],l=[],j,o,u=[],m=[],r=A.respData.dataList,w,k,p="";var s;var y;try{s=document.getElementsByClassName("seaImgLayout")[0].offsetHeight;y=document.getElementsByClassName("seaImgLayout")[1].offsetHeight}catch(z){}for(var t=0,v=r.length;t<v;t+=2){j={proNum:r[t].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(r[t].firstProdImg),proName:r[t].prodName,proPrice:"¥"+r[t].stdPrice};if(r[t].featureName===null||r[t].featureName===undefined){p=""}else{p=r[t].featureName}k={proId:r[t].prodNum,proListImg:privateVerifictionObj.verifiction.imgLink(r[t].firstProdImg),proName:r[t].prodName,proModel:"产品型号: "+p,proPrice:"¥"+r[t].stdPrice};if(t+1<v){o={proNum:r[t+1].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(r[t+1].firstProdImg),proName:r[t+1].prodName,proPrice:"¥"+r[t+1].stdPrice};if(r[t+1].featureName===null||r[t+1].featureName===undefined){p=""}else{p=r[t+1].featureName}w={proId:r[t+1].prodNum,proListImg:privateVerifictionObj.verifiction.imgLink(r[t+1].firstProdImg),proName:r[t+1].prodName,proModel:"产品型号: "+p,proPrice:"¥"+r[t+1].stdPrice}}if(y<s&&y!==undefined){if(privateVerifictionObj.verifiction.isNotNull(o)===true){var A=o;o=j;j=A}n=j;l.push(n);m.push(k);if(t+1<v){x=o;q.push(x);m.push(w)}}else{if(y===undefined&&s===undefined){if(i.proDatas.proLeftInfos.length>i.proDatas.proRightInfos.length){n=j;l.push(n);m.push(k);if(t+1<v){x=o;q.push(x);m.push(w)}}else{x=j;q.push(x);m.push(k);if(t+1<v){n=o;l.push(n);m.push(w)}}}else{x=j;q.push(x);m.push(k);if(t+1<v){n=o;l.push(n);m.push(w)}}}}u={proLeftInfos:q,proRightInfos:l,idataList:m};if(r.length<9){i.noMoreHide=false;i.loadingHide=true;g.setMoreHide(false);g.setLoadingHide(true)}return u};i.changeStyle=function(){i.showType=!i.showType;g.setShowType(i.showType);if(i.timeEvt){a.cancel(i.timeEvt)}i.timeEvt=a(function(){i.loadingImg()},500)};if(i.viewStates.getSearchResListState()===false){if(e==0){getOrPostRequestObj.proSearchConnec.userSearchPro("",h,i,f)}else{getOrPostRequestObj.proSearchConnec.userSearchPro(b,"",i,f)}i.viewStates.setSearchResListState(true)}else{i.proResList=g.getProResList().idataList;i.proDatas.proLeftInfos=g.getProResList().proLeftInfos;i.proDatas.proRightInfos=g.getProResList().proRightInfos;d=false;a(function(){i.loadingImg()},500)}i.resItemClick=function(j){c.path("/detailed").search({proNum:i.proResList[j].proId,dNum:3+i.getCategory()+i.getProduct()})};i.proLeftClick=function(j){c.path("/detailed").search({proNum:i.proDatas.proLeftInfos[j].proNum,dNum:3+i.getCategory()+i.getProduct()})};i.proRightClick=function(j){c.path("/detailed").search({proNum:i.proDatas.proRightInfos[j].proNum,dNum:3+i.getCategory()+i.getProduct()})}};var register=function(b,g,e,f,c){var d={color:"#ef575c"};var a={color:"#294775"};b.iTimer=60;b.verifiShow=true;b.register={};b.$on("modal.hidden",function(){if(privateVerifictionObj.verifiction.isNotNull(b.register.rPhone)===false||privateVerifictionObj.verifiction.isNotNull(b.register.rPass)===false||privateVerifictionObj.verifiction.isNotNull(b.register.rPassC)===false||privateVerifictionObj.verifiction.isNotNull(b.register.rverifi)===false){b.clearRegisterInfo();b.iTimer=60;b.verifiShow=true;try{c.cancle(b.iTimerMethod)}catch(h){}}});b.rphoneFocus=function(){b.registerPhone=d};b.rphoneBlur=function(){b.registerPhone=a};b.rpassFocus=function(){b.registerPass=d};b.rpassBlur=function(){b.registerPass=a};b.rpasscFocus=function(){b.registerPassC=d};b.rpasscBlur=function(){b.registerPassC=a};b.rnameFocus=function(){b.registerName=d};b.rnameBlur=function(){b.registerName=a};b.rverifiFocus=function(){b.registerVerifi=d};b.rverifiBlur=function(){b.registerVerifi=a};b.registerSend=function(){if(privateVerifictionObj.verifiction.iphonever(b.register.rPhone)===false){b.showAlert("提 示","手机号码格式输入错误!")}else{if(privateVerifictionObj.verifiction.isLetterAndNum(b.register.rPass)===false){b.showAlert("提 示","用户密码只能由字母或数字组成!")}else{if(b.register.rPass.length>12||b.register.rPass.length<6){b.showAlert("提 示","密码长度必须是6位-12位的数字或字母组成!")}else{if(privateVerifictionObj.verifiction.isNotNull(b.register.rPass)===false||privateVerifictionObj.verifiction.isNotNull(b.register.rPassC)===false){b.showAlert("提 示","密码不能为空!")}else{if(b.register.rPass!==b.register.rPassC){b.showAlert("提 示","两次用户密码输入不正确!")}else{if(b.register.rverifi===""||b.register.rverifi===undefined){b.showAlert("提 示","请输入验证码!")}else{b.register.rName=b.register.rPhone;getOrPostRequestObj.registConnect.userRegist(b,g)}}}}}}};b.getVerfiCode_CallBack=function(){};b.userLoginDone_CallBack=function(h){localStorage.setItem("userName",h+"");publicParameterObj.parameters.userName=localStorage.userName.replace(/\"/g,"");publicEventsObj.operatingDatabaseEvent.crateTable();getOrPostRequestObj.userAndAdminSignIn.userLoginState=true;getOrPostRequestObj.userAndAdminSignIn.testSetJushTagNalias(b,g)};b.registerDone_CallBack=function(h,i){getOrPostRequestObj.userAndAdminSignIn.userLogin(b,g,h,i);e.show({template:"<div>恭喜您注册成功!</div>",delay:100,duration:1000});b.clearRegisterInfo();var j=f.url().split("?")[0];if(j==="/personal"){c(function(){location.reload()},500)}else{f.path("/personal")}};b.getVerfiCode=function(){if(privateVerifictionObj.verifiction.iphonever(b.register.rPhone)===false){b.showAlert("提 示","请先填写正确的手机号码!")}else{getOrPostRequestObj.registConnect.userGetVerifiCodes(b,g);b.verifiShow=false;b.iTimer=60;b.verifiTimer()}};b.verifiTimer=function(){var h=1000;if(b.iTimer>=1){b.iTimer--;if(b.iTimer==0){h=200}b.iTimerMethod=c(function(){b.verifiTimer()},h)}else{b.verifiShow=true;c.cancle(b.iTimerMethod)}};b.clearRegisterInfo=function(){b.register.rPhone="";b.register.rPass="";b.register.rPassC="";b.register.rverifi=""}};searchResCtrl.$inject=["$scope","$http","searchResService","$location","$timeout"];var searchResarr=["$scope","$http","searchResService","$location","$timeout",searchResCtrl];indexModule.controller("searchRes",searchResarr);register.$inject=["$scope","$http","$ionicLoading","$location","$timeout"],indexModule.controller("registerCtrl",register);indexModule.service("shoppingCarService",function(){var b={};var c=true;var e=true;var d=false;var a=0;var f=[];b.getSendBtnHide=function(){return c};b.setSendBtnHide=function(g){c=g};b.getIsNone=function(){return e};b.setIsNone=function(g){e=g};b.getOpenEditPrice=function(){return d};b.setOpenEditPrice=function(g){d=g};b.getCountNum=function(){return a};b.setCountNum=function(g){a=g};b.getSpList=function(){return f};b.setSpList=function(g){f=g};return b});var shoppingCarCtrl=function(h,i,g,c,a,e,d,f){i.sendjson=[];i.sendBtnHide=c.getSendBtnHide();i.isNone=c.getIsNone();i.openEditPrice=c.getOpenEditPrice();i.countNum=c.getCountNum();i.closeEditPrice=false;i.editPriceHide=false;i.editBtn=true;i.iProNum=[];var b=0;i.addrPrompt="";i.data={addr:""};i.spBackHide=i.getPerSpCar()==0;i.$on("$stateChangeStart",function(k,j){if(i.spConfirm){i.spConfirm.close()}if(i.sporConfirm){i.sporConfirm.close()}});i.showShoppingCar=function(){if(localStorage.getItem("spc")==="[]"||localStorage.getItem("spc")===undefined){i.isNone=false;i.sendBtnHide=true;c.setSendBtnHide(true);c.setIsNone(false)}else{var l=JSON.parse(localStorage.getItem("spc"));i.iProNum.splice(0,i.iProNum.length);for(var k=0,j=l.length;k<j;k++){i.iProNum.push(l[k].myid);if(k===j-1){i.sendBtnHide=false;i.editBtn=false;c.setSendBtnHide(false)}}i.isNone=!(l.length===0);c.setIsNone(i.isNone);getOrPostRequestObj.shoppingCarConnect.getShoppingInfo(i,g);i.viewStates.setShoppingCarState(true)}};i.$on("$stateChangeSuccess",function(k,j){i.openEditPrice=false;i.closeEditPrice=true;i.editPriceHide=false;c.setOpenEditPrice(false);if(j.name==="shoppingCar"){if(i.viewStates.getShoppingCarState()===false){c.setCountNum(0);i.countNum=0;i.showShoppingCar()}else{i.spLists=c.getSpList();d(function(){i.loadingImg()},500);if(i.spLists.length>0){i.editBtn=false}}}});i.showConfirm=function(j){i.spConfirm=a.confirm({title:"提 示",content:"是否将该产品从购物车中删除?",buttons:[{text:"取 消",type:"alertCancel",onTap:function(k){return false}},{text:"确 定",type:"alertComfirm",onTap:function(k){return true}}]});i.spConfirm.then(function(k){if(k){var l=JSON.parse(localStorage.getItem("spc")).reverse();i.countNum=i.countNum-l[j].mynumber*i.spLists[j].price;if(privateVerifictionObj.verifiction.isInt(i.countNum)===false){i.countNum=privateVerifictionObj.verifiction.subNum(i.countNum,2)}publicEventsObj.operatingDatabaseEvent.deleteItemData(i.spLists[j].id);i.deletePro(j)}})};h.sendOrderConfirm=function(){i.sporConfirm=a.prompt({title:"请填写收货地址",template:"<div class='item-input-inset alertInputView'><label class='item-input-wrapper alertInput'><input ng-model='data.addr' type='text' class='ng-pristine ng-valid text-center' maxlength='50'></label></div><h3 class='text-center assertive errText' ng-bind='addrPrompt'></h3>",scope:i,buttons:[{text:"取 消",type:"alertCancel",onTap:function(j){return false}},{text:"确 定",type:"alertComfirm",onTap:function(j){if(i.data.addr!=""){return true}else{i.addrPrompt="收货地址不能为空!";j.preventDefault()}}}]});i.sporConfirm.then(function(m){if(m){var n=JSON.parse(localStorage.getItem("spc"));var l={};for(var k=0,j=n.length;k<j;k++){l="{'prodNum':'"+n[k].myid+"','cases':"+n[k].mynumber+",'differName':'"+n[k].myType+"'}";i.sendjson.push(l)}i.sendjson="["+i.sendjson+"]";getOrPostRequestObj.shoppingCarConnect.sendOrder(i,g);i.data.addr=""}i.addrPrompt=""})};i.shoppingCarInit_CallBack=function(k,j){c.setSpList(i.shoppingCharReturnData(k,j));i.spLists=c.getSpList();d(function(){i.loadingImg()},500)};i.shoppingCharReturnData=function(m){var l=m.respData;var p=[];var o;var n=JSON.parse(localStorage.getItem("spc")).reverse();for(var k=0,j=l.length;k<j;k++){o={name:l[k].prodName,img:privateVerifictionObj.verifiction.imgLink(l[k].firstProdImg),id:l[k].prodNum,price:l[k].stdPrice,num:n[k].mynumber,type:n[k].myType,border2x:false,boderNone:false};p.push(o);o={};i.countNum=i.countNum+l[k].stdPrice*n[k].mynumber;if(privateVerifictionObj.verifiction.isInt(i.countNum)===false){i.countNum=privateVerifictionObj.verifiction.subNum(i.countNum,2)}}c.setCountNum(i.countNum);return p};i.isLogin_CallBack=function(j){if(j){h.sendOrderConfirm()}else{d(function(){i.userLoginShowHide(true)},500)}};i.changeProNumber=function(k,j){var l=JSON.parse(localStorage.getItem("spc")).reverse();if(k==="add"){++i.spLists[j].num}else{if(i.spLists[j].num>1){--i.spLists[j].num}}i.countNum=i.countNum-l[j].mynumber*i.spLists[j].price+i.spLists[j].num*i.spLists[j].price;if(privateVerifictionObj.verifiction.isInt(i.countNum)===false){i.countNum=privateVerifictionObj.verifiction.subNum(i.countNum,2)}publicEventsObj.operatingDatabaseEvent.updateData(i.spLists[j].id,i.spLists[j].num,i.spLists[j].type);c.setCountNum(i.countNum);c.setSpList(i.spLists)};i.changeVal=function(j){var k=JSON.parse(localStorage.getItem("spc")).reverse();if(privateVerifictionObj.verifiction.isInt(i.spLists[j].num)){i.spLists[j].boderNone=false;i.spLists[j].border2x=false;b<=0?b=0:b--;i.countNum=i.countNum-k[j].mynumber*i.spLists[j].price+i.spLists[j].num*i.spLists[j].price;if(privateVerifictionObj.verifiction.isInt(i.countNum)===false){i.countNum=privateVerifictionObj.verifiction.subNum(i.countNum,2)}publicEventsObj.operatingDatabaseEvent.updateData(i.spLists[j].id,i.spLists[j].num,i.spLists[j].type);c.setCountNum(i.countNum)}else{i.spLists[j].border2x=true;b++}c.setSpList(i.spLists)};i.deletePro=function(j){i.spLists.splice(j,1);if(i.spLists.length===0){i.sendBtnHide=true;i.editBtn=true;i.isNone=false;c.setSendBtnHide(true);c.setIsNone(false)}c.setCountNum(i.countNum);c.setSpList(i.spLists)};i.openOrCloseEditPrice=function(){if(i.editPriceHide){if(b!==0){i.showAlert("提 示","请填写正确的商品数量!")}else{i.editPriceHide=false;i.closeEditPrice=true;i.openEditPrice=false;c.setOpenEditPrice(false)}}else{i.closeEditPrice=false;i.openEditPrice=true;i.editPriceHide=true;c.setOpenEditPrice(true)}};i.sendOrder=function(){getOrPostRequestObj.userAndAdminSignIn.isUserLogin(i,g)};i.sendOrder_CallBack=function(){publicEventsObj.operatingDatabaseEvent.deleteallData();i.spLists=[];i.sendjson=[];c.setSpList(i.spLists);i.viewStates.setWaitingState(false);i.viewStates.setShoppingCarState(false);f.show({template:"<div>订单提交成功!</div>",delay:100,duration:2000});e.path("/myOrder").replace()};i.showDetailed=function(j){if(i.editPriceHide===false){e.path("/detailed").search({proNum:j,hisPage:1})}};i.toProd=function(){e.path("/product")}};var superProCtrl=function(a,e,d,b){a.noMoreHide=true;a.loadingHide=false;a.pageNum=2;var c=true;a.$on("$stateChangeStart",function(){b.cancel(a.loadHttp)});a.superInit_CallBack=function(f){a.sproDatas=a.superReturnData(f);a.pageNum=2;b(function(){c=false},1000);b(function(){a.loadingImg()},500)};a.superLoadMore_CallBack=function(g){var f=a.superReturnData(g);a.sproDatas.proLeftInfos=a.sproDatas.proLeftInfos.concat(f.proLeftInfos);a.sproDatas.proRightInfos=a.sproDatas.proRightInfos.concat(f.proRightInfos);a.pageNum++;b(function(){c=false},1000);b(function(){a.loadingImg()},500)};a.superLoadMore=function(){if(a.noMoreHide&&c===false){c=true;a.loadHttp=b(function(){getOrPostRequestObj.superProConnect.superProListLoadMore(a,e);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.superReturnData=function(k){var s,m,o,l,r=[],g=[],q=k.respData.dataList;var p=document.getElementsByClassName("supImgLayout")[0].offsetHeight;var f=document.getElementsByClassName("supImgLayout")[1].offsetHeight;for(var j=0,n=q.length;j<n;j+=2){o={proNum:q[j].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(q[j].firstProdImg),proName:q[j].prodName,proPrice:"¥"+q[j].stdPrice};if(j+1<n){l={proNum:q[j+1].prodNum,proImg:privateVerifictionObj.verifiction.imgLink(q[j+1].firstProdImg),proName:q[j+1].prodName,proPrice:"¥"+q[j+1].stdPrice}}if(f<p||f==p){s=o;r.push(s);if(j+1<n){m=l;g.push(m)}}else{m=o;g.push(m);if(j+1<n){s=l;r.push(s)}}}var h={proLeftInfos:r,proRightInfos:g};if(q.length<14){a.noMoreHide=false;a.loadingHide=true}return h};a.proLeftClick=function(f){var g=a.getPerSpCar();a.setPerSpCar(g+4);d.path("/detailed").search({proNum:a.sproDatas.proLeftInfos[f].proNum})};a.proRightClick=function(f){var g=a.getPerSpCar();if(g>0){a.setPerSpCar(g+4)}else{a.setPerSpCar(4)}d.path("/detailed").search({proNum:a.sproDatas.proRightInfos[f].proNum})};getOrPostRequestObj.superProConnect.superProList(a,e)};shoppingCarCtrl.$inject=["$rootScope","$scope","$http","shoppingCarService","$ionicPopup","$location","$timeout","$ionicLoading"];var shoppingCararr=["$rootScope","$scope","$http","shoppingCarService","$ionicPopup","$location","$timeout","$ionicLoading",shoppingCarCtrl];indexModule.controller("shoppingCar",shoppingCararr);var userLoginCtrl=function(a,b,f,e,d,c){b.login={};b.savePwd={checked:privateVerifictionObj.verifiction.isNotNull(localStorage.getItem("sc"))&&localStorage.getItem("sc")==="true"?true:false};b.autoLogin={checked:privateVerifictionObj.verifiction.isNotNull(localStorage.getItem("ac"))&&localStorage.getItem("ac")==="true"?true:false};a.cancelAutoSave=function(){b.savePwd.checked=false;b.autoLogin.checked=false};a.alo=function(){try{var p=JSON.parse(localStorage.getItem("s")).c.split("s");var l=JSON.parse(localStorage.getItem("s")).v;var n=[];for(var i=0,k=p.length;i<k-1;i++){var h=p[i].split(".");if(h[0]!=0&&h[0]!=="0"){n.push(h[0].substr(0,h[0].length-1))}}n.push(p[p.length-1]);var o="";for(var j=0,g=n.length;j<g;j++){o+=l[n[j]]}b.login.userName=JSON.parse(localStorage.getItem("s")).u;if(b.savePwd.checked){b.login.userPass=o}if(b.autoLogin.checked){d.show({template:"<div>正在登录</div><ion-spinner icon='lines'></ion-spinner>",delay:100,duration:2000});c(function(){getOrPostRequestObj.userAndAdminSignIn.userLogin(b,f,b.login.userName,b.login.userPass)},2000)}}catch(m){}};b.iuserLogin=function(){getOrPostRequestObj.userAndAdminSignIn.userLogin(b,f,b.login.userName,b.login.userPass);if(b.savePwd.checked){var g=dcodeIO.bcrypt;var u=g.genSaltSync(10);var q=g.hashSync(b.login.userPass,u);var k=0;var m=[];var t=q.split("");for(var s=0,n=b.login.userPass.length;s<n;s++){var p;k=Math.round(Math.random()*(q.length-1));t.splice(k,0,b.login.userPass[s]);for(var o=0,p=m.length;o<=p;o++){if(p==0){m.push(k)}else{if(o!=p){if(m[o]>=k){m[o]++}if(o==p-1){m.push(k)}}}}}m=m.join(Math.random()+"s"+Math.random()+"s");q=t.join("");localStorage.setItem("s",JSON.stringify({u:b.login.userName,v:q,c:m}))}b.login.userPass=""};b.userLoginDone_CallBack=function(g){localStorage.setItem("sc",b.savePwd.checked);localStorage.setItem("ac",b.autoLogin.checked);localStorage.setItem("userName",g+"");publicParameterObj.parameters.userName=localStorage.userName.replace(/\"/g,"");publicEventsObj.operatingDatabaseEvent.crateTable();getOrPostRequestObj.userAndAdminSignIn.userLoginState=true;getOrPostRequestObj.userAndAdminSignIn.testSetJushTagNalias(b,f);b.toPersonal()};b.hideUserLogin=function(){var g=e.url().split("?")[0];switch(g){case"/personal":b.back();break;case"/modifyInfo":case"/modifyPass":case"/superPro":case"/myOrder":case"/waitingAudit":b.back(-2);break;case"/detailed":case"/message":b.pageHide();break;case"/shoppingCar":b.viewStates.setShoppingCarState(false);b.pageHide();break;default:b.back();break}};b.toPersonal=function(){switch(e.url().split("?")[0]){case"/personal":case"/modifyInfo":case"/modifyPass":case"/superPro":case"/myOrder":case"/waitingAudit":b.pageHide();location.reload();break;case"/shoppingCar":b.pageHide();a.sendOrderConfirm();break;case"/detailed":if(getOrPostRequestObj.userAndAdminSignIn.isToShoppingCar===true){e.path("/shoppingCar").search("")}else{b.pageHide()}break;case"/message":if(e.search().page==="editMessage"){b.userLogin.hide();b.editMessageShowHide(false)}else{e.path("/personal")}break;default:e.path("/personal")}};b.userNameFocus=function(){b.nameStyle={color:"#ef575c"}};b.userNameBlur=function(){b.nameStyle={color:"#294775"}};b.userPassFocus=function(){b.passStyle={color:"#ef575c"}};b.userPassBlur=function(){b.passStyle={color:"#294775"}}};superProCtrl.$inject=["$scope","$http","$location","$timeout"];indexModule.controller("superPro",superProCtrl);indexModule.service("modifyInfoService",function(){var a={};var f="未登录";var e="";var b="";var d="";var c="";a.getPerNameInfo=function(){return f};a.setPerNameInfo=function(g){f=g};a.getCompanyInfo=function(){return e};a.setCompanyInfo=function(g){e=g};a.getUserNameInfo=function(){return b};a.setUserNameInfo=function(g){b=g};a.getPhoneInfo=function(){return d};a.setPhoneInfo=function(g){d=g};a.getAddressInfo=function(){return c};a.setAddressInfo=function(g){c=g};return a});var modifyInfoCtrl=function(b,g,c,d,f){b.iInfoName=c.getPerNameInfo();var e={color:"#ef575c"};var a={color:"#294775"};b.modify={userCompany:c.getCompanyInfo(),userName:c.getUserNameInfo(),userPhone:c.getPhoneInfo(),userAddress:c.getAddressInfo()};b.muserCompanyFocus=function(){b.mCompany=e};b.muserCompanyBlur=function(){b.mCompany=a};b.muserNameFocus=function(){b.mName=e};b.muserNameBlur=function(){b.mName=a};b.muserPhoneFocus=function(){b.mPhone=e};b.muserPhoneBlur=function(){b.mPhone=a};b.muserAddressFocus=function(){b.mAddress=e};b.muserAddressBlur=function(){b.mAddress=a};b.userInfoInit_CallBack=function(h){b.iInfoName="用户名: "+h.respData.custName;b.modify.userCompany=h.respData.companyName;b.modify.userName=h.respData.contactPerson;b.modify.userPhone=h.respData.phoneNum;b.modify.userAddress=h.respData.address;b.updateInfo()};b.updateUserInfo=function(){if(b.modify.userCompany===""||b.modify.userCompany===undefined){b.showAlert("提 示","公司名不能为空!")}else{if(b.modify.userName===""||b.modify.userName===undefined){b.showAlert("提 示","联系人不能为空!")}else{if(b.modify.userPhone===""||b.modify.userPhone===undefined){b.showAlert("提 示","手机号码不能为空!")}else{if(privateVerifictionObj.verifiction.iphonever(b.modify.userPhone)===false){b.showAlert("提 示","手机号码格式不正确!")}else{getOrPostRequestObj.registConnect.userUpdateInfo(b,g)}}}}};b.updateUserInfoDone_CallBack=function(){f.show({template:"<div>个人信息修改完成!</div>",delay:100,duration:1000});b.updateInfo();b.viewStates.setPersonalState(false);window.history.back()};b.updateInfo=function(){c.setPerNameInfo(b.iInfoName);c.setCompanyInfo(b.modify.userCompany);c.setUserNameInfo(b.modify.userName);c.setPhoneInfo(b.modify.userPhone);c.setAddressInfo(b.modify.userAddress)};if(b.viewStates.getModifyState()===false){d(function(){getOrPostRequestObj.registConnect.userGetInfo(b,g)},450);b.viewStates.setModifyState(true)}};userLoginCtrl.$inject=["$rootScope","$scope","$http","$location","$ionicLoading","$timeout"];indexModule.controller("userLoginCtrl",userLoginCtrl);var modifyPassCtrl=function(b,e,d){var c={color:"#ef575c"};var a={color:"#294775"};b.updatePass={};b.oldPassFocus=function(){b.oldPassStyle=c};b.oldPassBlur=function(){b.oldPassStyle=a};b.newPassFocus=function(){b.newPassStyle=c};b.newPassBlur=function(){b.newPassStyle=a};b.newPassCFocus=function(){b.newPassCStyle=c};b.newPassCBlur=function(){b.newPassCStyle=a};b.clearData=function(){b.updatePass.oldPass="";b.updatePass.newPass="";b.updatePass.newPassC=""};b.modifyPassDone=function(){d.show({template:"<div>密码修改成功!</div>",delay:100,duration:1000})};b.modifyPassDone_CallBakc=function(){b.modifyPassDone();window.history.back()};b.sendNewPass=function(){if(privateVerifictionObj.verifiction.isLetterAndNum(b.updatePass.oldPass)===false){b.showAlert("提 示","旧密码输入错误，只能由数字或字母组成!")}else{if(privateVerifictionObj.verifiction.isLetterAndNum(b.updatePass.newPass)===false||b.updatePass.newPass===undefined){b.showAlert("提 示","新密码输入错误，只能由数字或字母组成!")}else{if(b.updatePass.newPass!==b.updatePass.newPassC){b.showAlert("提 示","新密码两次输入不一致!")}else{if(b.updatePass.newPass.length>12||b.updatePass.newPass<6){b.showAlert("提 示","密码长度必须是6位-12位的数字或字母组成!")}else{getOrPostRequestObj.userAndAdminSignIn.userModifyPass(b,e,b.updatePass.oldPass,b.updatePass.newPass)}}}}}};modifyInfoCtrl.$inject=["$scope","$http","modifyInfoService","$timeout","$ionicLoading"];var modifyInfoarr=["$scope","$http","modifyInfoService","$timeout","$ionicLoading",modifyInfoCtrl];indexModule.controller("modifyInfo",modifyInfoarr);modifyPassCtrl.$inject=["$scope","$http","$ionicLoading"];indexModule.controller("modifyPass",modifyPassCtrl);
