var operatingDatabaseEvent={crateTable:function(){if(localStorage.getItem(publicParameterObj.parameters.userName)==undefined){var a=[];localStorage.setItem(publicParameterObj.parameters.userName,JSON.stringify(a))}else{}},insertData:function(g,e,d){var f=JSON.parse(localStorage.getItem(publicParameterObj.parameters.userName));var b=f.length;for(var c=0,a=f.length;c<a;c++){if(f[c].myid==g){d.showAlert("提 示","这件商品已存在购物车中!");return}}f.push({myid:g,mynumber:e});localStorage.setItem(publicParameterObj.parameters.userName,JSON.stringify(f));if(f.length>b){d.viewStates.setShoppingCarState(false);d.showAlert("提 示","添加成功!")}else{d.showAlert("提 示","添加失败!")}},selectData:function(){var a=JSON.parse(localStorage.getItem(publicParameterObj.parameters.userName));return a},updateData:function(e,c){var d=JSON.parse(localStorage.getItem(publicParameterObj.parameters.userName));for(var b=0,a=d.length;b<a;b++){if(d[b].myid===e){if(d[b].mynumber!=c){d[b].mynumber=c;localStorage.setItem(publicParameterObj.parameters.userName,JSON.stringify(d));return}return}}},deleteItemData:function(d){var c=JSON.parse(localStorage.getItem(publicParameterObj.parameters.userName));for(var b=0,a=c.length;b<a;b++){if(c[b].myid===d){c.splice(b,1);localStorage.setItem(publicParameterObj.parameters.userName,JSON.stringify(c));return}}},deleteallData:function(){localStorage.removeItem(publicParameterObj.parameters.userName);publicEventsObj.operatingDatabaseEvent.crateTable()}};var publicEventsClass={operatingDatabaseEvent:Object.create(operatingDatabaseEvent)};var publicEventsObj=Object.create(publicEventsClass);var indexModule=angular.module("ionicApp",["ionic"]);var iconfig=function(b,a){publicEventsObj.operatingDatabaseEvent.crateTable();b.state("detailed",{url:"/detailed",templateUrl:"detailed.html",controller:"detailed"}).state("adminMenu",{url:"/adminMenu",templateUrl:"adminMenu.html",controller:"adminMenu"}).state("adminModifyPass",{url:"/adminModifyPass",templateUrl:"adminModifyPass.html",controller:"adminModifyPass"}).state("adminClient",{url:"/adminClient",templateUrl:"adminClientSearch.html",controller:"adminClient"}).state("adminProManage",{url:"/adminProManage",templateUrl:"adminProManage.html",controller:"adminProManage"}).state("adminSelectOrder",{url:"/adminSelectOrder",templateUrl:"adminSelectOrder.html",controller:"adminSelectOrder"}).state("historyOrder",{url:"/historyOrder",templateUrl:"historyOrder.html",controller:"historyOrder"}).state("adminOrderInfo",{url:"/adminOrderInfo",templateUrl:"adminOrderInfo.html",controller:"adminOrderInfo"});a.otherwise("/adminMenu")};var imainCtrl=function(n,i,f,d,a,b,l,j,k){n.acancelHide=false;n.abackHide=true;n.tabHide=true;n.tabBarHide=false;n.search={};n.text="<i class='ion-android-arrow-down icons'><span class='iconText'>正在加载</span></i>";n.sendMessageIsLogin=true;n.iMessageDatas="";n.indexIsShow=false;n.proIsShow=false;n.categoryIsShow=false;n.shoppingCarIsShow=false;if(localStorage.getItem("perSpCar")==undefined){localStorage.setItem("perSpCar",0)}n.perSpCar=localStorage.getItem("perSpCar")>>0;n.viewStates={};n.iState=false;var c=false;var h=false;var g=false;var m=false;var e=false;n.viewStates.getAdmMenuState=function(){return c};n.viewStates.setAdmMenuState=function(o){c=o};n.viewStates.getAdmSelOrderState=function(){return h};n.viewStates.setAdmSelOrderState=function(o){h=o};n.viewStates.getAdmProManageState=function(){return g};n.viewStates.setAdmProManageState=function(o){g=o};n.viewStates.getAdmClientState=function(){return m};n.viewStates.setAdmClientState=function(o){m=o};n.viewStates.getHistoryOrderState=function(){return e};n.viewStates.setHistoryOrderState=function(o){e=o};getOrPostRequestObj.detailedConnect.isCom(n,i);n.showAlert=function(p,o){n.iShowAlert=a.alert({title:p,content:o,buttons:[{text:"确 定",type:"alertCancel"}]});n.iShowAlert.then(function(q){})};n.setPerSpCar=function(o){n.perSpCar=o;localStorage.setItem("perSpCar",o)};n.getPerSpCar=function(){var o=localStorage.getItem("perSpCar");o=!!o?parseInt(o):!!o;n.perSpCar=o;return n.perSpCar};n.setCategory=function(o){localStorage.setItem("isCategory",o)};n.getCategory=function(){var o=localStorage.getItem("isCategory");return !!o?parseInt(o):!!o};n.setProduct=function(o){localStorage.setItem("isProduct",o)};n.getProduct=function(){var o=localStorage.getItem("isProduct");return !!o?parseInt(o):!!o};n.getIState=function(){return n.iState};n.setIState=function(o){n.iState=o};n.back=function(o){if(o!==undefined&&o!==null&&o!=0){window.history.go(o);if(n.perSpCar>2){var q=n.perSpCar+o;n.setPerSpCar(q)}}else{if(n.perSpCar>0&&o!=0){var p=n.perSpCar-1;n.setPerSpCar(p)}window.history.back()}};n.admLoginLode=function(){d(function(){n.adminLoginShowHide(true)},500)};n.userLoginLoad=function(){d(function(){n.userLoginShowHide(true)},500)};n.pageHide=function(){if(n.userLogin){n.userLoginShowHide(false)}if(n.iregister){n.userRegisterShowHide(false)}};n.$on("$stateChangeStart",function(p,o){publicParameterObj.parameters.loadingPage=0;n.isIndex=o.name==="index";n.indexIsShow=false;n.proIsShow=false;n.categoryIsShow=false;n.shoppingCarIsShow=false;n.navBarIsHide=false;n.isSpNewPage=true;if(k.viewHistory().histories.root.cursor==-1){if(o.name==="adminMenu"){localStorage.removeItem("view")}if(localStorage.getItem("view")!==undefined&&localStorage.getItem("view")!==null){k.sviewHistory(JSON.parse(localStorage.getItem("view")))}}localStorage.setItem("view",JSON.stringify(k.viewHistory()));if(n.iShowAlert){n.iShowAlert.close()}});n.indexBarIconState=function(){n.indexIsShow=!n.indexIsShow};n.proBarIconState=function(){n.proIsShow=!n.proIsShow};n.categoryBarIconState=function(){n.categoryIsShow=!n.categoryIsShow};n.shoppingCarIconState=function(){n.shoppingCarIsShow=!n.shoppingCarIsShow};l.fromTemplateUrl("adminLogin.html",function(o){n.adminLogin=o},{scope:n,animation:"slide-in-up"});n.adminLoginShowHide=function(o){o?n.adminLogin.show():n.adminLogin.hide()};n.editMessageShowHide=function(o){if(o===true){getOrPostRequestObj.userAndAdminSignIn.isUserLogin(n,i);f.search({page:"editMessage"}).replace();n.editContent.show()}else{f.search("").replace();n.editContent.hide()}};n.loadingImg=function(){function p(){return window.navigator.userAgent.toLowerCase().indexOf("msie")>=1}var o=p();(function(){var w=$$("mainContent");if(w!==undefined&&w!==null&&w.getElementsByTagName("img")!==undefined&&w.getElementsByTagName("img")!==null){var v=w.getElementsByTagName("img").length,s=[];for(var u=0,x=v;u<x;u++){var r=w.getElementsByTagName("img")[u];if(r){r.setAttribute("_lazysrc",r.getAttribute("_lazysrc")+"?"+Math.random());s.push(r)}}var t=new ImagesLazyLoad({container:window,mode:"vertical",holder:"img/nopic.jpg",onLoad:function(y){y.onload=function(){q(this)}}});function q(y){var z=setInterval(function(){var A=o?y.filters.alpha.opacity:y.style.opacity*100;if(A<100){o?y.filters.alpha.opacity+=10:y.style.opacity=(A+10)/100}else{clearInterval(z)}},15)}}})()}};iconfig.$inject=["$stateProvider","$urlRouterProvider"];indexModule.config(iconfig);imainCtrl.$inject=["$scope","$http","$location","$timeout","$ionicPopup","$ionicPopover","$ionicModal","$ionicBackdrop","$ionicHistory"];indexModule.controller("mainCtrl",imainCtrl);indexModule.service("admClientService",function(){var a={};var h=false;var b=true;var f=true;var d=false;var g="";var e="";var c=2;a.getNameClick=function(){return h};a.setNameClick=function(i){h=i};a.getPhoneClick=function(){return b};a.setPhoneClick=function(i){b=i};a.getMoreHide=function(){return f};a.setMoreHide=function(i){f=i};a.getLoadingHide=function(){return d};a.setLoadingHide=function(i){d=i};a.getSearchKey=function(){return g};a.setSearchKey=function(i){g=i};a.getClients=function(){return e};a.setClients=function(i){e=i};a.getPageNum=function(){return c};a.setPageNum=function(i){c=i};return a});var adminClientCtrl=function(a,g,b,f,c){a.keyColor="keyColor-link";a.keyColors="keyColor-active";a.isNameClick=b.getNameClick();a.isPhoneClick=b.getPhoneClick();a.noMoreHide=b.getMoreHide();a.loadingHide=b.getLoadingHide();a.clientSearchEvt=null;a.pageNum=b.getPageNum();a.aClient={searchKey:b.getSearchKey()};var e=b.getSearchKey();var d=true;a.$on("$stateChangeStart",function(){c.cancel(a.loadHttp)});a.$on("$stateChangeSuccess",function(i,h){if(h.name==="adminClient"){if(a.viewStates.getAdmClientState()===false){getOrPostRequestObj.adminClientSearchConnect.adminSearchUserInfo(a,g);a.viewStates.setAdmClientState(true)}else{a.iClients=b.getClients();d=false}}});a.adminClientInit_CallBack=function(h){b.setClients(a.adminClientReturnData(h));a.iClients=b.getClients();a.pageNum=2;b.setPageNum(2);c(function(){d=false},1000)};a.adminClientLoadMore_CallBack=function(i){var h=a.adminClientReturnData(i);a.iClients=a.iClients.concat(h);b.setClients(a.iClients);a.pageNum++;b.setPageNum(a.pageNum);c(function(){d=false},1000)};a.adminClientLoadMore=function(){if(a.noMoreHide&&d===false){d=true;a.loadHttp=c(function(){getOrPostRequestObj.adminClientSearchConnect.adminUserInfoLoadMore(a,g);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.adminClientReturnData=function(h){if(h.respData.dataList.length<9){a.noMoreHide=false;a.loadingHide=true;b.setMoreHide(false);b.setLoadingHide(true)}return h.respData.dataList};a.searchTextChange=function(){b.setSearchKey(a.aClient.searchKey)};a.searchUser=function(){if(e!==a.aClient.searchKey){getOrPostRequestObj.adminClientSearchConnect.searchName="";getOrPostRequestObj.adminClientSearchConnect.searchPhone="";a.pageNum=1;b.setPageNum(1);a.noMoreHide=true;a.loadingHide=false;if(a.isNameClick===false){getOrPostRequestObj.adminClientSearchConnect.searchName=a.aClient.searchKey}else{if(a.isPhoneClick===false){getOrPostRequestObj.adminClientSearchConnect.searchPhone=a.aClient.searchKey}}getOrPostRequestObj.adminClientSearchConnect.adminSearchUserInfo(a,g);d=true}e=a.aClient.searchKey};a.clickKey=function(h){a.isNameClick=true;a.isPhoneClick=true;switch(h){case 1:a.isNameClick=!a.isNameClick;break;case 2:a.isPhoneClick=!a.isPhoneClick;break;default:break}b.setNameClick(a.isNameClick);b.setPhoneClick(a.isPhoneClick)};a.searchUserOrder=function(h){a.viewStates.setHistoryOrderState(false);f.path("/historyOrder").search({custNum:a.iClients[h].custNum,custName:a.iClients[h].companyName})}};var adminLoginCtrl=function(a,c,b){a.cancelHide=false;a.backHide=true;a.alogin={};a.adminNameFocus=function(){a.anameStyle={color:"#ef575c"}};a.adminNameBlur=function(){a.anameStyle={color:"#294775"}};a.adminPassFocus=function(){a.apassStyle={color:"#ef575c"}};a.adminPassBlur=function(){a.apassStyle={color:"#294775"}};a.hideAdminLogin=function(){var d=b.url().split("?")[0];switch(d){case"/adminMenu":a.back();break;case"/adminModifyPass":case"/adminClient":case"/adminSelectOrder":case"/adminProManage":a.back(-2);break;case"/adminOrderInfo":case"/historyOrder":a.back(-3);break;default:a.adminLoginShowHide(false)}};a.toAdminMenu=function(){switch(b.url().split("?")[0]){case"/adminMenu":case"/adminModifyPass":case"/adminClient":case"/adminSelectOrder":case"/adminProManage":case"/adminOrderInfo":location.reload();break;default:b.path("/adminMenu");break}};a.adminLoginBtnEvt=function(){if(a.alogin.adminName===""||a.alogin.adminName===undefined){a.showAlert("提 示","账号不能为空!")}else{if(a.alogin.adminPass===""||a.alogin.adminPass===undefined){a.showAlert("提 示","密码不能为空!")}else{getOrPostRequestObj.userAndAdminSignIn.adminLogin(a,c)}}};a.adminLoginDone_CallBack=function(){a.toAdminMenu();a.alogin.adminPass=""}};adminClientCtrl.$inject=["$scope","$http","admClientService","$location","$timeout"];var adminClientarr=["$scope","$http","admClientService","$location","$timeout",adminClientCtrl];indexModule.controller("adminClient",adminClientarr);indexModule.service("adminMenuService",function(){var a={};var c="未登录";var b="";a.getCompany=function(){return c};a.setCompany=function(d){c=d};a.getName=function(){return b};a.setName=function(d){b=d};return a});var adminMenuCtrl=function(a,f,e,c,d,b){a.adminCompany=e.getCompany();a.adminName=e.getName();a.$on("$stateChangeStart",function(){if(a.admMenuConfirms){a.admMenuConfirms.close()}});a.$on("$stateChangeSuccess",function(h,g){if(g==="adminMenu"){a.viewStates.setAdmSelOrderState(false);a.viewStates.setAdmProManageState(false);a.viewStates.setAdmSelOrderState(false)}});a.admMenuConfirm=function(){a.admMenuConfirms=c.confirm({title:"提 示",content:"您确定要退出登录吗?",buttons:[{text:"取 消",type:"alertCancel",onTap:function(g){return false}},{text:"确 定",type:"alertComfirm",onTap:function(g){return true}}]});a.admMenuConfirms.then(function(g){if(g){e.setCompany("未登录");e.setName("");a.adminCompany="未登陆";a.adminName="";getOrPostRequestObj.userAndAdminSignIn.adminLoginOut(a,f);a.viewStates.setAdmMenuState(false);a.viewStates.setAdmClientState(false);a.viewStates.setAdmProManageState(false);a.viewStates.setAdmSelOrderState(false)}else{}})};a.adminInfo_CallBack=function(g){a.adminCompany=g.respData.companyName;a.adminName=g.respData.adminName;e.setCompany(g.respData.companyName);e.setName(g.respData.adminName);a.viewStates.setAdmMenuState(true)};a.adminOutLogin=function(){a.admMenuConfirm()};a.admList=function(g){switch(g){case 0:d.path("/adminSelectOrder");break;case 1:d.path("/adminProManage");break;case 2:d.path("/adminClient");break;case 3:d.path("/adminModifyPass");break}};a.refresh=function(){b(function(){getOrPostRequestObj.adminInfoConnect.getAdminInfo(a,f)},500)};if(a.viewStates.getAdmMenuState()===false){b(function(){getOrPostRequestObj.adminInfoConnect.getAdminInfo(a,f)},500)}};adminLoginCtrl.$inject=["$scope","$http","$location"];indexModule.controller("adminLoginCtrl",adminLoginCtrl);var adminModifyPassCtrl=function(b,e,d){var c={color:"#ef575c"};var a={color:"#294775"};b.aupdatePass={};b.aoldPassFocus=function(){b.aoldPassStyle=c};b.aoldPassBlur=function(){b.aoldPassStyle=a};b.anewPassFocus=function(){b.anewPassStyle=c};b.anewPassBlur=function(){b.anewPassStyle=a};b.anewPassCFocus=function(){b.anewPassCStyle=c};b.anewPassCBlur=function(){b.anewPassCStyle=a};b.clearData=function(){b.aupdatePass.oldPass="";b.aupdatePass.newPass="";b.aupdatePass.newPassC=""};b.amodifyPassDone=function(){d.show({template:"<div>密码修改成功!</div>",delay:100,duration:1000})};b.amodifyPassDone_CallBack=function(){b.amodifyPassDone();window.history.back()};b.asendNewPass=function(){if(privateVerifictionObj.verifiction.isLetterAndNum(b.aupdatePass.oldPass)===false){b.showAlert("提 示","旧密码输入错误，只能由数字或字母组成!")}else{if(privateVerifictionObj.verifiction.isLetterAndNum(b.aupdatePass.newPass)===false||b.aupdatePass.newPass===undefined){b.showAlert("提 示","新密码输入错误，只能由数字或字母组成!")}else{if(b.aupdatePass.newPass!==b.aupdatePass.newPassC){b.showAlert("提 示","新密码两次输入不一致!")}else{getOrPostRequestObj.userAndAdminSignIn.isAdminLegality(b,e,b.aupdatePass.oldPass,b.aupdatePass.newPass)}}}}};adminMenuCtrl.$inject=["$scope","$http","adminMenuService","$ionicPopup","$location","$timeout"];var adminMenuCtrlarr=["$scope","$http","adminMenuService","$ionicPopup","$location","$timeout",adminMenuCtrl];indexModule.controller("adminMenu",adminMenuCtrlarr);var adminOrderInfoCtrl=function(a,d,c,b){a.iOrderId=c.search().orderId;a.toDetailed=function(e){c.path("/detailed").search({proNum:e,hisPage:1})};a.aOrderInfoInit_CallBack=function(i){var l=[],g={},h=[],k;for(var f=0,e=i.orderItemList.length;f<e;f++){g={proId:i.orderItemList[f].prodNum,img:privateVerifictionObj.verifiction.imgLink(i.orderItemList[f].whereimg),name:i.orderItemList[f].prodName,num:"订购数量 : "+i.orderItemList[f].cases,price:"¥"+i.orderItemList[f].custProdPrice};h.push(g)}k={orderNum:i.orderNum,userName:i.custName,proCount:i.orderItemList.length,proPrices:"¥"+i.custPriceTotal,cashState:i.cashStatusName,cashType:i.cashTypeName,deliveryState:i.deliverStatusName,date:i.createDate,iPros:h};l.push(k);a.aOrderInfos=l;b(function(){a.loadingImg()},500)};getOrPostRequestObj.adminSelectOrderConnect.adminGetOrderInfo(a,d)};adminModifyPassCtrl.$inject=["$scope","$http","$ionicLoading"];indexModule.controller("adminModifyPass",adminModifyPassCtrl);indexModule.service("admProManageService",function(){var a={};var e="";var d={};var g=true;var c=false;var f="";var b=2;a.getSearchText=function(){return e};a.setSearchText=function(h){e=h};a.getData=function(){return d};a.setData=function(h){d=h};a.getMoreHide=function(){return g};a.setMoreHide=function(h){g=h};a.getLoadingHide=function(){return c};a.setLoadingHide=function(h){c=h};a.getaEditPros=function(){return f};a.setaEditPros=function(h){f=h};a.getPageNum=function(){return b};a.setPageNum=function(h){b=h};return a});var adminProManageCtrl=function(a,h,d,g,f,b){a.aProManage={searchVal:d.getSearchText()};a.iProId="";a.iProVlaue="";a.pricePrompt="";a.pricePrompt1="";a.numPrompt="";a.index=0;a.data=d.getData();a.noMoreHide=d.getMoreHide();a.loadingHide=d.getLoadingHide();a.manageSearchEvt=null;a.pageNum=d.getPageNum();var c=d.getSearchText();var e=true;a.$on("$stateChangeStart",function(j,i){if(a.iPrompt){a.iPrompt.close()}if(a.iPrompt1){a.iPrompt1.close()}b.cancel(a.loadHttp);if(i.name!=="detailed"&&i.name==="adminProManage"){a.viewStates.setAdmProManageState(false)}});a.$on("$stateChangeSuccess",function(j,i){if(i.name==="adminProManage"){if(a.viewStates.getAdmProManageState()===false){getOrPostRequestObj.adminProManageConnect.adminGetProList(a,h);a.viewStates.setAdmProManageState(true)}else{a.aEditPros=d.getaEditPros();e=false;b(function(){a.loadingImg()},500)}}});a.toDetailed=function(i){g.path("/detailed").search({proNum:i,hisPage:1})};a.updatePrice=function(i){a.index=i;a.data.price=a.aEditPros[i].price.replace("¥","");a.iPrompt=f.prompt({title:"修改产品价格",template:"<div class='item-input-inset alertInputView'><label class='item-input-wrapper alertInput'><input ng-model='data.price' type='text' class='ng-pristine ng-valid text-center'></label></div><h3 class='text-center assertive errText' ng-bind='pricePrompt'></h3><h4 class='text-center assertive errText' ng-bind='pricePrompt1'></h4>",scope:a,buttons:[{text:"取 消",type:"alertCancel",onTap:function(j){return false}},{text:"确 定",type:"alertComfirm",onTap:function(j){if(a.data.price===""||a.data.price===undefined){a.pricePrompt="价格不能为空!";j.preventDefault()}else{if(privateVerifictionObj.verifiction.isFloat(a.data.price)===false){a.pricePrompt="价格输入有误!";a.pricePrompt1="注:小数点后只允许2位小数.";j.preventDefault()}else{return true}}}}]});a.iPrompt.then(function(j){if(j){a.iProId=a.aEditPros[i].proId;a.iProVlaue=a.data.price;getOrPostRequestObj.adminProManageConnect.updatePrice(a,h)}else{}a.pricePrompt="";a.pricePrompt1=""});d.setData(a.data)};a.updateNum=function(i){a.index=i;a.data.num=a.aEditPros[i].num;a.iPrompt1=f.prompt({title:"修改产品数量",template:"<div class='item-input-inset alertInputView'><label class='item-input-wrapper alertInput'><input ng-model='data.num' type='text' class='ng-pristine ng-valid text-center'></label></div><h3 class='text-center assertive errText' ng-bind='numPrompt'></h3>",scope:a,buttons:[{text:"取 消",type:"alertCancel",onTap:function(j){return false}},{text:"确 定",type:"alertComfirm",onTap:function(j){if(a.data.num===""||a.data.num===undefined){a.numPrompt="数量不能为空!";j.preventDefault()}else{if(privateVerifictionObj.verifiction.isInt(a.data.num)===false){a.numPrompt="数量输入有误!";j.preventDefault()}else{return true}}}}]});a.iPrompt1.then(function(j){if(j){a.iProId=a.aEditPros[i].proId;a.iProVlaue=a.data.num;getOrPostRequestObj.adminProManageConnect.updateNum(a,h)}else{}a.numPrompt=""});d.setData(a.data)};a.searchChange=function(){d.setSearchText(a.aProManage.searchVal)};a.aProManageSearch=function(){if(a.aProManage.searchVal!==c){getOrPostRequestObj.adminProManageConnect.adminGetProList(a,h);a.pageNum=1;d.setPageNum(1);a.noMoreHide=true;a.loadingHide=false;d.setMoreHide(true);d.setLoadingHide(false);e=true}c=a.aProManage.searchVal};a.adminProManageInit_CallBack=function(i){d.setaEditPros(a.adminProManageRetrunData(i));a.aEditPros=d.getaEditPros();a.pageNum=2;d.setPageNum(2);b(function(){e=false},1000);b(function(){a.loadingImg()},500)};a.adminProManageLoadMore_CallBack=function(j){var i=a.adminProManageRetrunData(j);a.aEditPros=a.aEditPros.concat(i);d.setaEditPros(a.aEditPros);a.pageNum++;d.setPageNum(a.pageNum);b(function(){e=false},1000);b(function(){a.loadingImg()},500)};a.adminProManageLoadMore=function(){if(a.noMoreHide&&e===false){e=true;a.loadHttp=b(function(){getOrPostRequestObj.adminProManageConnect.adminProListLoadMore(a,h);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.adminProManageRetrunData=function(m){var o=[],l=m.respData.dataList,n={};for(var k=0,j=l.length;k<j;k++){n={name:l[k].prodName,proId:l[k].prodNum,img:privateVerifictionObj.verifiction.imgLink(l[k].firstProdImg),price:"¥"+l[k].stdPrice,num:l[k].dispStockBalance,date:"上架日期: "+l[k].createDate};o.push(n)}if(l.length<9){a.noMoreHide=false;a.loadingHide=true;d.setMoreHide(false);d.setLoadingHide(true)}return o};a.updatePriceDone_CallBack=function(){var i=a.data.price;i=(i+"").replace(/^0+\./g,"0.");i.match(/^0+[1-9]+/)?i=i.replace(/^0+/g,""):i;a.aEditPros[a.index].price="¥"+i};a.updateNumDone_CallBack=function(){a.aEditPros[a.index].num=a.data.num.replace(/\b(0+)/gi,"")}};adminOrderInfoCtrl.$inject=["$scope","$http","$location","$timeout"];indexModule.controller("adminOrderInfo",adminOrderInfoCtrl);indexModule.service("admSelService",function(){var a={};var e={};var h=true;var d=false;var c=2;var b="";var g=false;var f=true;a.getData=function(){return e};a.setData=function(i){e=i};a.getMoreHide=function(){return h};a.setMoreHide=function(i){h=i};a.getLoadingHide=function(){return d};a.setLoadingHide=function(i){d=i};a.getPageNum=function(){return c};a.setPageNum=function(i){c=i};a.getSearchVal=function(){return b};a.setSearchVal=function(i){b=i};a.getCompany=function(){return g};a.setCompany=function(i){g=i};a.getPhone=function(){return f};a.setPhone=function(i){f=i};return a});var adminSelectOrderCtrl=function(a,g,f,b,e){a.adminOrder={searchVal:""};a.iCustNum="";a.keyColor="keyColor-link";a.keyColors="keyColor-active";a.isCompanyClick=false;a.isPhoneClick=true;a.noMoreHide=true;a.loadingHide=false;a.selSearchEvt=null;a.pageNum=2;var c="";var d=true;a.$on("$stateChangeStart",function(i,h){b.cancel(a.loadHttp)});a.$on("$stateChangeSuccess",function(i,h){if(h.name==="adminSelectOrder"){if(a.viewStates.getAdmSelOrderState()===false){getOrPostRequestObj.adminSelectOrderConnect.aUserCompany="";getOrPostRequestObj.adminSelectOrderConnect.aUserPhoneNum="";getOrPostRequestObj.adminSelectOrderConnect.adminShowOrderList(a,g);a.viewStates.setAdmSelOrderState(true)}else{a.adminOrder.searchVal=e.getSearchVal();a.aOrders=e.getData();a.isCompanyClick=e.getCompany();a.isPhoneClick=e.getPhone();a.noMoreHide=e.getMoreHide();a.loadingHide=e.getLoadingHide();a.pageNum=e.getPageNum();d=false;b(function(){a.loadingImg()},500)}}});a.adminOrderInit_CallBack=function(h){a.aOrders=a.adminOrderReturnData(h);a.pageNum=2;b(function(){d=false},1000);b(function(){a.loadingImg()},500);e.setData(a.aOrders);e.setPageNum(2)};a.adminOrderLoadMore_CallBack=function(i){var h=a.adminOrderReturnData(i);a.aOrders=a.aOrders.concat(h);a.pageNum++;b(function(){d=false},1000);b(function(){a.loadingImg()},500);e.setData(a.aOrders);e.setPageNum(a.pageNum)};a.adminOrderLoadMore=function(){if(a.noMoreHide&&d===false){d=true;a.loadHttp=b(function(){getOrPostRequest.adminSelectOrderConnect.adminSelOrderLoadMore(a,g);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.adminOrderReturnData=function(o){var k=[],s=o.respData.dataList,u,h=[],r=[],t,l=true;for(var n=0,q=s.length;n<q;n++){for(var m=0,p=s[n].orderItemList.length;m<p;m++){u={proId:s[n].orderItemList[m].prodNum,img:privateVerifictionObj.verifiction.imgLink(s[n].orderItemList[m].whereimg),name:s[n].orderItemList[m].prodName,num:s[n].orderItemList[m].cases,price:"¥"+s[n].orderItemList[m].custProdPrice,type:s[n].orderItemList[m].differName};if(m<3){h.push(u)}else{r.push(u);l=false}}t={orderNum:s[n].orderNum,userName:s[n].custName,proCount:s[n].orderItemList.length,proPrices:"¥"+s[n].custPriceTotal,cashState:s[n].cashStatusName,deliveryState:s[n].deliverStatusName,date:s[n].createDate,iPros:h,isHidePro:true,iHidePros:r,isHide:l,btnText:"显示全部"};l=true;r=[];h=[];k.push(t)}if(s.length<9){a.noMoreHide=false;a.loadingHide=true;e.setLoadingHide(true);e.setMoreHide(false)}return k};a.toDetailed=function(h){f.path("/detailed").search({proNum:h,hisPage:1})};a.searchChange=function(){e.setSearchVal(a.adminOrder.searchVal)};a.toOrderDetailed=function(h){f.path("/adminOrderInfo").search({orderId:a.aOrders[h].orderNum})};a.clickKey=function(h){a.isCompanyClick=true;a.isPhoneClick=true;if(h===1){a.isCompanyClick=!a.isCompanyClick}else{a.isPhoneClick=!a.isPhoneClick}e.setCompany(a.isCompanyClick);e.setPhone(a.isPhoneClick)};a.hideShowPro=function(h){a.aOrders[h].isHidePro=!a.aOrders[h].isHidePro;a.aOrders[h].isHidePro?a.aOrders[h].btnText="显示全部":a.aOrders[h].btnText="隐藏部分";e.setData(a.aOrders)};a.orderSearch=function(){if(a.adminOrder.searchVal!==c){getOrPostRequestObj.adminSelectOrderConnect.aUserCompany="";getOrPostRequestObj.adminSelectOrderConnect.aUserPhoneNum="";a.pageNum=1;a.noMoreHide=true;a.loadingHide=false;if(a.isCompanyClick===false){getOrPostRequestObj.adminSelectOrderConnect.aUserCompany=a.adminOrder.searchVal}else{getOrPostRequestObj.adminSelectOrderConnect.aUserPhoneNum=a.adminOrder.searchVal}e.setLoadingHide(false);e.setMoreHide(true);e.setPageNum(1);getOrPostRequestObj.adminSelectOrderConnect.adminShowOrderList(a,g);d=true}c=a.adminOrder.searchVal}};adminProManageCtrl.$inject=["$scope","$http","admProManageService","$location","$ionicPopup","$timeout"];var adminProManagearr=["$scope","$http","admProManageService","$location","$ionicPopup","$timeout",adminProManageCtrl];indexModule.controller("adminProManage",adminProManagearr);adminSelectOrderCtrl.$inject=["$scope","$http","$location","$timeout","admSelService"];var adminSelectOrderarr=["$scope","$http","$location","$timeout","admSelService",adminSelectOrderCtrl];indexModule.controller("adminSelectOrder",adminSelectOrderarr);indexModule.service("detaiService",function(){var a={};var b=0;a.getDNum=function(){return b};a.setDNum=function(c){b=c};return a});var detailedCtrl=function(i,c,g,b,d){var e="";var a="";i.shoppingType=0;i.detailed={proNum:0};var h=d.search().dNum;var f=d.search().hisPage;d.search({proNum:d.search().proNum,hisPage:d.search().hisPage}).replace();i.cartHide=f==1;i.detailedInit_CallBack=function(m){var r=i.detailedReturnData(m);i.detailedDatas=r;for(var n=0,o=m.prodExternals.length;n<o;n++){if(m.prodExternals[n].externalName==="murl"){a=m.prodExternals[n].externalValue}else{e=m.prodExternals[n].externalValue}}try{if(m.prodExternals.externalValue!==undefined&&m.prodExternals.externalValue!==null){i.isToAl=m.prodExternals.externalValue.substring(0,4)==="http"}else{i.isToAl=false}}catch(q){i.isToAl=false}var s=r.islides;var t=[];for(var l=0,u=s.length;l<u;l++){t.push({content:"<div class='detailed_bannerImg' ><img src='"+s[l].iSlideImg+"' onerror=this.src=errImg></div>"})}var k={type:"dom",data:t,dom:document.getElementById("detailedSwiper"),duration:3000,isLooping:true,isAutoplay:true,onslidechange:function(j){p.changeIndexDot()}};if(s.length>0){var p=new iSlider(k);var v={top:"42%",width:"100%",diameter:"0.8em",borderColor:"#365b88"};p.renderDot(v)}};i.detailedReturnData=function(q){var n,t=q,r=[],l=[],s="",k="",u="";for(var p=0,m=t.prodImgs.length;p<m;p++){s=privateVerifictionObj.verifiction.imgLink(t.prodImgs[p].thumbUrl);l.push({iSlideImg:s})}for(var o=0,v=t.prodFeatures.length;o<v;o++){k=t.prodFeatures[o].featureName;u=t.prodFeatures[o].ifeatureValue;r.push({extFeatrue:k+": "+u})}n={detailedTitle:t.prodName,islides:l,price:"¥"+t.stdPrice,balance:t.dispStockBalance,extFeatrue:r,data:t.createDate,remark:t.remark,external:t.prodExternals};return n};i.$on("$stateChangeStart",function(){getOrPostRequestObj.userAndAdminSignIn.isToShoppingCar=false});if(d.search().proNum!==""){getOrPostRequestObj.detailedConnect.getDetailed(d.search().proNum,i,g)}else{i.detailedDatas={detailedTitle:"产品获取失败，请返回重新选择产品。"}}};detailedCtrl.$inject=["$scope","detaiService","$http","$timeout","$location"];var detailedarr=["$scope","detaiService","$http","$timeout","$location",detailedCtrl];indexModule.controller("detailed",detailedarr);indexModule.service("historyOrderService",function(){var a={};var d=false;var c=true;var b="";a.getMoreHide=function(){return d};a.setMoreHide=function(e){d=e};a.getLoadingHide=function(){return c};a.setLoadingHide=function(e){c=e};a.getHistoryOrder=function(){return b};a.setHistoryOrder=function(e){b=e};return a});var historyOrderCtrl=function(a,f,c,e,b){a.iCustNum="";a.noMoreHide=c.getMoreHide();a.loadingHide=c.getLoadingHide();var d=true;if(e.search().custNum){a.iCustNum=e.search().custNum;a.companyTitle=e.search().custName}a.$on("$stateChangeSuccess",function(h,g){if(g.name==="historyOrder"){if(a.viewStates.getHistoryOrderState()===false){getOrPostRequestObj.adminSelectOrderConnect.adminShowOrderList(a,f);a.viewStates.setHistoryOrderState(true)}else{a.histroyOrders=c.getHistoryOrder();d=false;b(function(){a.loadingImg()},500)}}});a.adminOrderInit_CallBack=function(g){c.setHistoryOrder(a.adminOrderReturnData(g));a.histroyOrders=c.getHistoryOrder();publicParameterObj.parameters.loadingPage=2;b(function(){d=false},1000);b(function(){a.loadingImg()},500)};a.adminOrderLoadMore_CallBack=function(h){var g=a.adminOrderReturnData(h);a.histroyOrders=a.histroyOrders.concat(g);c.setHistoryOrder(a.histroyOrders);publicParameterObj.parameters.loadingPage++;b(function(){d=false},1000);b(function(){a.loadingImg()},500)};a.adminOrderLoadMore=function(){if(a.noMoreHide&&d===false){d=true;b(function(){getOrPostRequest.adminSelectOrderConnect.adminSelOrderLoadMore(a,f);a.$broadcast("scroll.infiniteScrollComplete")},1000)}else{a.$broadcast("scroll.infiniteScrollComplete")}};a.adminOrderReturnData=function(n){var h=[],r=n.respData.dataList,t,g=[],q=[],s,k=true;for(var m=0,p=r.length;m<p;m++){for(var l=0,o=r[m].orderItemList.length;l<o;l++){t={proId:r[m].orderItemList[l].prodNum,img:privateVerifictionObj.verifiction.imgLink(r[m].orderItemList[l].whereimg),name:r[m].orderItemList[l].prodName,num:r[m].orderItemList[l].cases,price:"¥"+r[m].orderItemList[l].custProdPrice};if(l<3){g.push(t)}else{q.push(t);k=false}}s={orderNum:r[m].orderNum,userName:r[m].custName,proCount:r[m].orderItemList.length,proPrices:"¥"+r[m].custPriceTotal,cashState:r[m].cashStatusName,deliveryState:r[m].deliverStatusName,date:r[m].createDate,iPros:g,isHidePro:true,iHidePros:q,isHide:k,btnText:"显示全部"};k=true;q=[];g=[];h.push(s)}if(r.length<9){a.noMoreHide=false;a.loadingHide=true;c.setMoreHide(false);c.setLoadingHide(true)}return h};a.toDetailed=function(g){e.path("/detailed").search({proNum:g,hisPage:1})};a.toOrderDetailed=function(g){e.path("/adminOrderInfo").search({orderId:a.histroyOrders[g].orderNum})};a.hideShowPro=function(g){a.histroyOrders[g].isHidePro=!a.histroyOrders[g].isHidePro;a.histroyOrders[g].isHidePro?a.histroyOrders[g].btnText="显示全部":a.histroyOrders[g].btnText="隐藏部分";c.setHistoryOrder(a.histroyOrders)}};historyOrderCtrl.$inject=["$scope","$http","historyOrderService","$location","$timeout"];var histroryOrderarr=["$scope","$http","historyOrderService","$location","$timeout",historyOrderCtrl];indexModule.controller("historyOrder",histroryOrderarr);
